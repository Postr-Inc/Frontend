(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9971:function(e,t,s){Promise.resolve().then(s.bind(s,6557))},6557:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return O}});var l,a,o,r=s(7437),n=s(2265);function i(e){let[t,s]=(0,n.useState)("home");return window.matchMedia("(prefers-color-scheme: dark)").matches,(0,r.jsx)("div",{className:" fixed bottom-8 left-[50%] transform -translate-x-1/2    w-80 ",children:(0,r.jsxs)("ul",{style:{borderRadius:"1rem"},className:"menu menu-horizontal rounded-box  w-fit \n    ".concat(window.matchMedia("(prefers-color-scheme: dark)").matches?"bg-darker text-white fill-white stroke-white":"bg-base-200","\n    "),children:[(0,r.jsx)("li",{children:(0,r.jsx)("a",{onClick:()=>{e.swapPage("home")},children:(0,r.jsx)("svg",{className:"\n                w-7 h-7\n                cursor-pointer\n                 \n                ",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",id:"home",children:(0,r.jsx)("path",{d:"M6.63477851,18.7733424 L6.63477851,15.7156161 C6.63477851,14.9350667 7.27217143,14.3023065 8.05843544,14.3023065 L10.9326107,14.3023065 C11.310188,14.3023065 11.6723007,14.4512083 11.9392882,14.7162553 C12.2062757,14.9813022 12.3562677,15.3407831 12.3562677,15.7156161 L12.3562677,18.7733424 C12.3538816,19.0978491 12.4820659,19.4098788 12.7123708,19.6401787 C12.9426757,19.8704786 13.2560494,20 13.5829406,20 L15.5438266,20 C16.4596364,20.0023499 17.3387522,19.6428442 17.9871692,19.0008077 C18.6355861,18.3587712 19,17.4869804 19,16.5778238 L19,7.86685918 C19,7.13246047 18.6720694,6.43584231 18.1046183,5.96466895 L11.4340245,0.675869015 C10.2736604,-0.251438297 8.61111277,-0.221497907 7.48539114,0.74697893 L0.967012253,5.96466895 C0.37274068,6.42195254 0.0175522924,7.12063643 0,7.86685918 L0,16.568935 C0,18.4638535 1.54738155,20 3.45617342,20 L5.37229029,20 C6.05122667,20 6.60299723,19.4562152 6.60791706,18.7822311 L6.63477851,18.7733424 Z",transform:"translate(2.5 2)"})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("a",{children:(0,r.jsx)("svg",{className:" w-7 h-7 cursor-pointer text-gray-500  hover:text-black  ",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("a",{children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:" w-7 h-7 cursor-pointer text-gray-500  hover:text-black  ",onClick:()=>{document.getElementById("createPost").showModal()},children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 3.75H6A2.25 2.25 0 003.75 6v1.5M16.5 3.75H18A2.25 2.25 0 0120.25 6v1.5m0 9V18A2.25 2.25 0 0118 20.25h-1.5m-9 0H6A2.25 2.25 0 013.75 18v-1.5M15 12a3 3 0 11-6 0 3 3 0 016 0z"})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("a",{children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:" w-7 h-7 cursor-pointer text-gray-500  hover:fill-black hover:text-black   ",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("a",{children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:" w-7 h-7",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0118 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0118 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 016 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"})})})})]})})}function c(e){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("dialog",{style:e.style,id:e.id,className:"sm:modal \n              ".concat("dark"===theme?"bg-black ":"bg-white ","\n              xl:rounded-box  \n              \n              "),children:(0,r.jsx)("div",{style:{width:e.width,height:e.height},className:"       shadow-none  \n                  ".concat(e.className,"\n                "),children:e.children})})})}var d=s(1109);function h(){return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]})}(l=a||(a={})).AUTH_WITH_PASSWORD="authwithpassword",l.OAUTH="oauth",l.ISRATELIMITED="isRatelimited",l.ISONLINE="ping",l.AUH_GUIDED_HANDSHAKE="authGuidedHandshake",l.REFRESH_TOKEN="tokenRefresh",l.FETCH_FILE="fetchFile",l.CHECK_ONLINE="checkStatus",l.CHANGE_PASSWORD="changePassword",l.LIST="list",l.AUTH_UPDATE="authUpdate",l.REALTIME_SUBSCRIBE="realtime",l.REALTIME_UNSUBSCRIBE="unsubscribe",l.DELETE="delete",o="function"==typeof atob?atob:function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var s,l,a,o="",r=0;s=t.charAt(r++);)-1!==(s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s))&&(l=a%4?64*l+s:s,a++%4&&(o+=String.fromCharCode(255&l>>(-2*a&6))));return o};let m={get:e=>localStorage.getItem(e),set:(e,t)=>localStorage.setItem(e,t),remove:e=>localStorage.removeItem(e),clear:()=>localStorage.clear()};class u{checkConnection(){return this.ws.readyState===WebSocket.OPEN}getRawFileData(e){return new Promise((t,s)=>{let l=new FileReader;l.onload=()=>{let e=l.result,s=new Uint8Array(e);t(s)},l.onerror=e=>{s(e)},l.readAsArrayBuffer(e)})}checkName(e){return new Promise((t,s)=>{e||s(Error("email or username is required")),this.callbacks.set("checkname",e=>{e.error?s(Error(e.error)):t(e.exists)}),console.log({...e.includes("@")?{email:e}:{username:e}}),this.sendMessage(JSON.stringify({type:"checkname",key:"checkname",data:{...e.includes("@")?{email:e}:{username:e}},session:this.sessionID}))})}changePassword(e){let{currentPassword:t,newPassword:s,confirmedPassword:l}=e}appendToQueue(e){if(!e.requestID&&!this.queue.has(e.requestID))return}waitForSocketConnection(e){let t=()=>{this.ws.readyState===WebSocket.OPEN?null!=e&&e():this.ws.readyState===WebSocket.CLOSED||this.ws.readyState===WebSocket.CLOSING?(console.error("WebSocket connection closed or failed."),null!=e&&e(Error("WebSocket connection closed or failed."))):setTimeout(t,100)};t(),setTimeout(()=>{this.ws.readyState!==WebSocket.OPEN&&null!=e&&e(Error("WebSocket connection timed out."))},5e3)}getAsByteArray(e){return new Promise((t,s)=>{let l=new FileReader;l.onload=()=>{let e=l.result,s=new Uint8Array(e);t(Array.from(s))},l.onerror=e=>{s(e)},l.readAsArrayBuffer(e)})}oauth(e){return new Promise((t,s)=>{if(e.provider){if(e.redirect_uri){let{provider:l,redirect_uri:a,redirect:o}=e;this.callbacks.set("oauth",e=>{e.url&&window.open(e.url),e.clientData?(localStorage.setItem("postr_auth",JSON.stringify({model:e.clientData.record,token:e.clientData.token})),t(e.clientData),window.dispatchEvent(this.changeEvent)):e.error&&s(Error(e.error))}),this.sendMessage(JSON.stringify({type:"oauth",data:e,session:this.sessionID}))}else throw Error("redirect_uri is required")}else throw Error("provider is required")})}onmessage(e){let t=JSON.parse(e.data);if(this.callbacks.has(t.key))this.callbacks.get(t.key)(t.data?t.data:t);else if("status"===t.type)t.data.forEach(e=>{this.online.set("online",e);{let e=setTimeout(()=>{window.dispatchEvent(this.onlineEvent),clearTimeout(e)},1e3)}});else if("pong"==t.type){let e=Date.now()-t.time;this.online.set("latency",e);{let e=setTimeout(()=>{window.dispatchEvent(this.onlineEvent),clearTimeout(e)},1e3)}}}async read(e){return new Promise((t,s)=>{e.collection||s(Error("collection is required")),this.authStore.isValid||s(Error("token is expired")),this.sendMessage(JSON.stringify({type:"read",key:this.callback(t,s),collection:e.collection,token:JSON.parse(m.get("postr_auth")||"{}").token,cacheKey:e.cacheKey||null,id:e.id,returnable:e.returnable,expand:e.expand,session:this.sessionID,authKey:e.authKey||null}))})}update(e){return new Promise((t,s)=>{crypto.randomUUID(),e.collection||s(Error("collection is required")),e.record||s(Error("data is required")),this.authStore.isValid||s(Error("token is expired")),this.sendMessage(JSON.stringify({type:"update",key:this.callback(t,s),data:e.record,expand:e.expand,collection:e.collection,skipDataUpdate:e.skipDataUpdate||!1,invalidateCache:e.invalidateCache||null,immediatelyUpdate:e.immediatelyUpdate||!1,sort:e.sort,filter:e.filter,token:JSON.parse(m.get("postr_auth")||"{}").token,id:e.id,session:this.sessionID,cacheKey:e.cacheKey||null}))})}list(e){return new Promise((t,s)=>{var l;this.currType="list",e.collection||s(Error("collection is required")),this.authStore.isValid||s(Error("token is expired")),this.sendMessage(JSON.stringify({type:"list",key:this.callback(t,s),token:this.authStore.model().token,data:{returnable:e.returnable||null,collection:e.collection,sort:e.sort,filter:e.filter,cacheTime:e.cacheTime||null,refresh:e.refresh||!1,refreshEvery:e.refreshEvery||0,limit:e.limit,offset:e.page,id:(null===(l=this.authStore.model())||void 0===l?void 0:l.id)||null,expand:e.expand||null,cacheKey:e.cacheKey},session:this.sessionID}))})}delete(e){return new Promise((t,s)=>{e.collection||s(Error("collection is required")),this.authStore.isValid||s(Error("token is expired"));let l=this.callback(t,s);this.sendMessage(JSON.stringify({type:"delete",key:l,collection:e.collection,ownership:this.authStore.model().id,filter:e.filter,token:this.authStore.model().token,id:e.id||null,session:this.sessionID,cacheKey:e.cacheKey||null}))})}callback(e,t){let s=crypto.randomUUID();return this.callbacks.set(s,l=>{l.error&&t(l.error),this.callbacks.delete(s),e(l)}),s}async create(e){return new Promise((t,s)=>{crypto.randomUUID(),e.collection||s(Error("collection is required")),e.record||s(Error("record is required")),"users"===e.collection||this.authStore.isValid||s(Error("token is expired")),this.sendMessage(JSON.stringify({method:"create",type:"create",key:this.callback(t,s),invalidateCache:e.invalidateCache||null,expand:e.expand,record:e.record,collection:e.collection,token:this.authStore.model().token,id:this.authStore.model().id||null,session:this.sessionID,cacheKey:e.cacheKey||null}))})}subscribe(e,t){let s=crypto.randomUUID();if(!event)throw Error("event is required");if(e.collection||Error("collection is required"),t&&"function"!=typeof t||Error("callback is required"),!this.subscriptions.has("".concat(this.sessionID,"-").concat(e.collection)))return this.callbacks.set(s,e=>{if(e.error)throw Error(e.error);t(e)}),this.subscriptions.set("".concat(this.sessionID,"-").concat(e.collection),!0),console.log("Subscribing to event",e.event),this.sendMessage(JSON.stringify({type:"realtime",key:s,eventType:e.event,collection:e.collection,token:this.authStore.model().token,session:this.sessionID})),{unsubscribe:()=>{this.callbacks.delete(s),this.sendMessage(JSON.stringify({type:"unsubscribe",key:s,session:this.sessionID}))}}}close(){this.ws.close()}constructor(e){this.queue=new Map,this.events={emit:(e,t)=>{window.dispatchEvent(new CustomEvent(e,{detail:t}))},on:(e,t)=>{window.addEventListener(e,e=>{t(e)})}},this.isSubscribed=e=>this.subscriptions.has(e),this.cdn={url:e=>"".concat(this.pbUrl,"/api/files/").concat(e.collection,"/").concat(e.id,"/").concat(e.file),getFile:e=>new Promise((t,s)=>{let l=crypto.randomUUID();e.collection||s(Error("collection is required")),e.recordId||s(Error("recordId is required")),e.field||s(Error("field is required")),this.callbacks.set(l,e=>{e.error&&s(e.error);let l=new Blob([new Uint8Array(e.file)],{type:e.type}),a=new File([l],e.fileName,{type:e.fileType}),o=new FileReader;o.onload=()=>{t(o.result)},o.readAsDataURL(a)}),this.sendMessage(JSON.stringify({type:"fetchFile",key:l,collection:e.collection,field:e.field,recordID:e.recordId,token:this.authStore.model().token,session:this.sessionID}))})},this.cacheStore={set:(e,t,s)=>{if(s){let l={value:t,cacheTime:s,time:new Date().getTime()};this.$memoryCache.set(e,JSON.stringify(l))}else this.$memoryCache.set(e,t)},update:(e,t)=>{let s=this.$memoryCache.get(e);s&&(s.cacheTime?(s.value=t,s.time=new Date().getTime(),this.$memoryCache.set(e,JSON.stringify(s))):this.$memoryCache.set(e,t))},get:e=>{let t=this.$memoryCache.get(e);return t?t.cacheTime?new Date().getTime()-t.time>t.cacheTime?(this.$memoryCache.delete(e),null):t.value:t:null},delete:e=>{this.$memoryCache.delete(e)},has:e=>this.$memoryCache.has(e),all:()=>this.$memoryCache.entries(),keys:()=>Array.from(this.$memoryCache.keys())},this.authStore={refreshToken:async()=>{console.log("Refreshing token"),this.callbacks.set("tokenRefresh",e=>new Promise((t,s)=>{if(e.error)return s(e);localStorage.setItem("postr_auth",JSON.stringify({model:this.authStore.model(),token:e.token||this.authStore.model().token})),window.dispatchEvent(this.changeEvent)})),this.sendMessage(JSON.stringify({type:"refreshToken",key:a.REFRESH_TOKEN,token:this.authStore.model().token,session:this.sessionID}))},resetPassword:async(e,t)=>new Promise((s,l)=>{if(!t||!e)return l(Error("email, password and token are required"));this.callbacks.set("resetPassword",e=>{e.error&&l(e),s(e),this.callbacks.delete("resetPassword")}),console.log({password:t,token:e}),this.sendMessage(JSON.stringify({type:"changePassword",key:"resetPassword",data:{password:t,token:e},session:this.sessionID}))}),requestPasswordReset:async e=>new Promise((t,s)=>{if(!e)return s(Error("email is required"));this.callbacks.set("requestPasswordReset",e=>{e.error&&s(e.error),t(e),this.callbacks.delete("requestPasswordReset")}),this.sendMessage(JSON.stringify({type:"requestPasswordReset",key:"requestPasswordReset",data:{email:e},session:this.sessionID}))}),login:async(e,t)=>new Promise((s,l)=>{this.callbacks.set("auth&password",e=>{e.clientData?(localStorage.setItem("postr_auth",JSON.stringify({model:e.clientData.record,token:e.clientData.token})),s(e.clientData.record),this.callbacks.delete("auth&password"),window.dispatchEvent(this.changeEvent)):e.error&&(l(Error(e.error)),this.callbacks.delete("auth&password"))}),this.sendMessage(JSON.stringify({type:"auth&password",data:{emailOrUsername:e,password:t},key:"auth&password",session:this.sessionID}))}),create:async e=>new Promise((t,s)=>{if(!e.username||!e.email||!e.password)return s(Error("username, email and password are required"));this.callbacks.set("authCreate",e=>(console.log(e),e.error)?s(e):t(e)),this.sendMessage(JSON.stringify({type:"authCreate",key:"authCreate",data:e,session:this.sessionID}))}),update:()=>{localStorage.getItem("postr_auth")&&(this.callbacks.set("authUpdate",e=>{if(e.error&&e.hasOwnProperty("isValid")&&!e.isValid)console.error(e);else if(e.error)throw Error(e);else e.clientData&&console.log("Auth updated"+e.clientData)}),this.sendMessage(JSON.stringify({type:a.AUTH_UPDATE,token:this.authStore.model().token,key:"authUpdate",data:JSON.parse(localStorage.getItem("postr_auth")).model,session:this.sessionID})))},model:e=>{if(!e)return{...JSON.parse(m.get("postr_auth")||"{}").model,token:JSON.parse(m.get("postr_auth")||"{}").token};localStorage.setItem("postr_auth",JSON.stringify({model:e,token:JSON.parse(m.get("postr_auth")||"{}").token}))},onChange:e=>{window.addEventListener("authChange",t=>{let s=t.detail;e(s)})},isValid:()=>{let e=localStorage.getItem("postr_auth")?JSON.parse(m.get("postr_auth")||"{}").token:null;return!!e&&!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;var s=function(e){if(e)try{var t=decodeURIComponent(o(e.split(".")[1]).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(t)||{}}catch(e){console.error("Error decoding token payload:",e)}return{}}(e).exp;return!!s&&Date.now()>=(s-t)*1e3}(e)},img:()=>this.cdn.url({id:this.authStore.model().id,collection:"users",file:this.authStore.model().avatar}),isRatelimited:async e=>new Promise((t,s)=>{this.callbacks.set("isRatelimited",e=>{e.error&&s(e.error),t(e),this.callbacks.delete("isRatelimited")}),this.sendMessage(JSON.stringify({type:"isRatelimited",key:"isRatelimited",token:this.authStore.model().token,method:e,session:this.sessionID}))}),clear:()=>{try{m.remove("postr_auth"),window.dispatchEvent(this.changeEvent)}catch(e){console.error(e)}}},this.onlineEvent=new CustomEvent("online"),this.changeEvent=new CustomEvent("change"),this.sessionID=crypto.randomUUID(),this.isStandalone=!1,this.subscriptions=new Map,this.ws=new WebSocket("".concat(e.wsUrl.trim().startsWith("127")||e.wsUrl.trim().startsWith("localhost")?"ws":"wss","://").concat(e.wsUrl)),this.$memoryCache=new Map,window.postr={version:" 1.7.0"},this.token=JSON.parse(m.get("postr_auth")||"{}")?JSON.parse(m.get("postr_auth")||"{}").token:null,this.cancellation=e.cancellation,this.sendMessage=e=>new Promise((t,s)=>{this.waitForSocketConnection(()=>{this.ws.send(e),t(0)})}),this.currType="",this.pbUrl=e.pbUrl,this.callbacks=new Map,this.ws.onmessage=e=>this.onmessage(e);let t=()=>{console.log("Connected to server"),this.ws.send(JSON.stringify({type:"authSession",token:this.token,session:this.sessionID}))};this.ws.onopen=()=>{t()};let s=!1,l=()=>{this.ws=new WebSocket("".concat(e.wsUrl.trim().startsWith("127")||e.wsUrl.trim().startsWith("localhost")?"ws":"wss","://").concat(e.wsUrl)),this.ws.onmessage=e=>this.onmessage(e),this.ws.onopen=()=>{t(),this.authStore.refreshToken(),s=!1},this.ws.onclose=()=>{console.log("Connection closed unexpectedly"),s=!1,r()},console.log("Reconnecting to server")};function r(){s||(s=!0,setTimeout(()=>{l()},1e3))}this.ws.onclose=()=>{r()},this.online=new Map,this.changeEvent=new CustomEvent("authChange",{detail:{model:JSON.parse(m.get("postr_auth")||"{}").model,token:JSON.parse(m.get("postr_auth")||"{}")?JSON.parse(m.get("postr_auth")||"{}").token:null}}),this.onlineEvent=new CustomEvent("online",{detail:{online:this.online}}),window.onbeforeunload=()=>{this.sendMessage(JSON.stringify({type:"close",token:this.token,session:this.sessionID})).then(()=>{this.ws.close()}),this.subscriptions.forEach((e,t)=>{this.sendMessage(JSON.stringify({type:"unsubscribe",key:t,token:this.authStore.model().token,session:this.sessionID}))})};let n=setInterval(()=>{this.$memoryCache.forEach((e,t)=>{let s=JSON.parse(e);s.time&&new Date().getTime()-s.time>s.cacheTime&&(this.$memoryCache.delete(t),clearInterval(n))})},1e3),i=setInterval(()=>{this.ws.readyState!==WebSocket.OPEN||clearInterval(i)},1e3)}}let x=new u({wsUrl:"localhost:8080",pbUrl:"https://postrapi.pockethost.io",cancellation:!0});function Comment(e){var t,s,l;let[a,o]=(0,n.useState)([e.likes]);async function i(){!0===a.includes(x.authStore.model().id)?(o(a.filter(e=>e!=x.authStore.model().id)),await x.update({collection:"posts",cacheKey:e.post.cacheKey,id:e.post.id,expand:["author","likes","comments","comments.user"],skipDataUpdate:!0,record:{expand:{comments:e.post.expand.comments.map(t=>t.id!=e.id?t:Array.isArray(t.likes)?(t.likes=t.likes.filter(e=>e!=x.authStore.model().id),t):{...t,likes:[]}),likes:e.post.expand.likes,author:e.post.expand.author}}})):(o([...a,x.authStore.model().id]),await x.update({collection:"posts",cacheKey:e.post.cacheKey,id:e.post.id,expand:["author","likes","comments","comments.user"],skipDataUpdate:!0,record:{expand:{comments:e.post.expand.comments.map(t=>t.id!=e.id?t:Array.isArray(t.likes)?(t.likes.push(x.authStore.model().id),t):{...t,likes:[x.authStore.model().id]}),likes:e.post.expand.likes,author:e.post.expand.author}}}))}return(0,n.useEffect)(()=>{o(a.flat())},[]),(0,r.jsxs)("div",{className:"flex flex-col w-full  \n     ".concat(2==e.level?"p-5":""," \n     ").concat(e.isLast?"xl:mb-auto lg:mb-auto md:mb-auto mb-[10rem]":"","\n     ").concat("view"==e.currentPage?"p-2 xl:p-0 mt-2":"","\n     ").concat(e.statusPage?" xl:p-5\n      ".concat("dark"==theme?"hover:bg-[#090909] text-white ":"hover:bg-[#f2f2f2d0]","\n        \n       \n      "):"","\n    "),children:[(0,r.jsxs)("div",{className:"flex flex-col relative  gap-2 ".concat(e.statusPage?"":"p-2"," w-full  "),children:[(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)("img",{src:x.cdn.url({id:null===(t=e.user)||void 0===t?void 0:t.id,collection:"users",file:null===(s=e.user)||void 0===s?void 0:s.avatar}),alt:"profile",className:"rounded object-cover w-12 h-12 cursor-pointer"}),(0,r.jsxs)("div",{className:"flex h-0 mt-2 mx-2 gap-2 hero ",children:[(0,r.jsx)("p",{children:null===(l=e.user)||void 0===l?void 0:l.username}),(0,r.jsxs)("p",{onClick:()=>{var t;e.setParams({user:null===(t=e.post)||void 0===t?void 0:t.expand.author}),e.swapPage("user")},className:"  text-sm opacity-60 cursor-pointer sm:hidden ",children:["@",e.expand.user.username]}),a.includes(e.post.expand.author.id)?(0,r.jsx)("div",{className:"flex  flex-row gap-2 p-2 text-sm",children:(0,r.jsxs)("div",{className:"hero flex gap-2",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.2,stroke:"currentColor",className:"w-4 h-4 fill-rose-500 stroke-rose-500",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})}),"by"," ",e.post.author==x.authStore.model().id?"you":e.post.expand.author.username]})}):null,e.expand.user.validVerified?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-6 fill-blue-500 text-white h-6",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})}):null,(0,r.jsx)("p",{children:"\xb7"}),(0,r.jsxs)("p",{className:"opacity-50 font-semibold text-sm",children:[" ",(()=>{let t=new Date(e.created),s=(new Date().getTime()-t.getTime())/1e3,l=s/60,a=l/60,o=a/24,r=o/7,n=r/4,i=n/12;switch(!0){case s<60:return"".concat(Math.floor(s),"s");case l<60:return"".concat(Math.floor(l),"m");case a<24:return"".concat(Math.floor(a),"h");case o<7:return"".concat(Math.floor(o),"d");case r<4:return"".concat(Math.floor(r),"w");case n<12:return"".concat(Math.floor(n),"mo");case i>1:return"".concat(Math.floor(i),"y")}})()]}),(0,r.jsxs)("div",{className:"justify-between flex flex-row w-full  absolute end-0",children:[(0,r.jsx)("div",{className:"flex flex-row gap-5"}),(0,r.jsxs)("details",{className:"dropdown dropdown-left",children:[(0,r.jsx)("summary",{className:"m-1 ",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 cursor-pointer",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})})}),(0,r.jsxs)("ul",{style:{borderRadius:"10px"},className:"p-2 shadow menu dropdown-content z-[1]  \n                  ".concat("dark"==theme?"bg-black text-white border-[#121212] border-2":"bg-white text-black","\n                  rounded-box w-52"),children:[e.user.id==x.authStore.model().id?(0,r.jsx)("li",{children:(0,r.jsx)("a",{onClick:e.deleteComment,children:"Delete"})}):null,(0,r.jsx)("li",{children:(0,r.jsx)("a",{children:"Item 2"})})]})]})]})]})]}),(0,r.jsx)("p",{className:" overflow-hidden break-words ",children:e.text})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-5 ".concat(e.statusPage?"mt-2  mb-5":"p-2"," "),children:[(0,r.jsxs)("div",{className:"relative flex ",style:{alignItems:"center",justifyContent:"center"},children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"\n          hover:bg-rose-500 hover:rounded-full hover:bg-opacity-20   hover:p-2 hover:text-[#f57288]\n          focus:bg-rose-500 focus:rounded-full focus:bg-opacity-20   focus:p-2 focus:text-[#f57288]\n           w-6 h-6 cursor-pointer ".concat(a.includes(x.authStore.model().id)?"fill-rose-500 text-rose-500":"  text-gray","\n          "),onClick:i,children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})}),a.length>0?(0,r.jsx)("p",{className:"mx-2",children:a.length}):""]}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3"})}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-6 h-6 cursor-pointer",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})})]}),e.isUserReplyPage||e.statusPage?"":(0,r.jsx)("p",{onClick:()=>{e.mentions.includes(e.user.username)||(e.setComment((null==e?void 0:e.comment)+"@".concat(e.user.username," ")),e.setMentions([...null==e?void 0:e.mentions,e.user.username]))},className:"mx-2 text-sm cursor-pointer",children:"Reply"})]})}function p(e){var t,s;let[l,a]=(0,n.useState)(""),[o,i]=(0,n.useState)([]);async function c(){if(!0==l.length<1);else try{let t=x.authStore.model();delete t.token,x.create({collection:"comments",record:{user:x.authStore.model().id,text:l,post:e.post.id,likes:[]},expand:["user"]}).then(async t=>{let s=[...e.comments,t];await x.update({collection:"posts",cacheKey:e.cacheKey,id:e.post.id,immediatelyUpdate:!0,record:{expand:{comments:s,author:e.post.expand.author},comments:[...e.comments.map(e=>e.id),t.id]}}),e.setComments(s)})}catch(e){console.log(e);return}}return(0,r.jsx)("dialog",{id:e.id,className:"   fixed top-0 left-0 w-full sm:modal placeholder: xl:rounded-xl  m-auto   right-16  h-[80vh] f md:mt-5  md:rounded-xl  md:w-[40vw] xl:w-[30vw]    \n          ".concat("dark"==theme?"bg-black text-white border-[#121212] border-2":"bg-white text-black","\n          "),children:(0,r.jsxs)("div",{className:"   xl:rounded-xl \n          ".concat("dark"==theme?"bg-black text-white border-[#121212] border-2":"bg-white text-black","\n          scroll h-full w-full  shadow-none   "),children:[(0,r.jsx)("div",{className:"flex flex-col   p-3 w-full  ",children:(0,r.jsxs)("div",{className:"flex flex-row w-full justify-between absolute p-2    xl:p-6  z-[999] top-0 left-0   ".concat("dark"==theme?"bg-black text-white":"bg-white text-black","  "),children:[(0,r.jsx)("button",{className:"btn btn-circle focus:outline-none btn-ghost btn-sm bg-none hover:bg-base-200",onClick:()=>{var t;null===(t=document.getElementById(e.id))||void 0===t||t.close()},children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M18 10a.75.75 0 0 1-.75.75H4.66l2.1 1.95a.75.75 0 1 1-1.02 1.1l-3.5-3.25a.75.75 0 0 1 0-1.1l3.5-3.25a.75.75 0 1 1 1.02 1.1l-2.1 1.95h12.59A.75.75 0 0 1 18 10Z",clipRule:"evenodd"})})}),(0,r.jsx)("div",{children:"Comments"}),(0,r.jsx)("div",{})]})}),(0,r.jsx)("div",{className:"flex flex-col lg:mb-32 md:mb-32 xl:mb-32   mt-8  p-4 \n          ".concat(o.length>0?"sm:mb-64":"","\n          sm:p-2 gap-5"),children:e.comments.length>0?e.comments.map((t,s)=>(0,r.jsx)("div",{style:{borderTop:"dark"==theme?"1px solid #121212":"1px solid #f9f9f9"},children:(0,r.jsx)(Comment,{isLast:s==e.comments.length-1,id:t.id,expand:t.expand,comments:e.comments,level:1,likes:t.likes,post:e.post,text:t.text,created:t.created,user:t.expand.user,setParams:e.setParams,setComment:a,comment:l,setMentions:i,mentions:o,swapPage:e.swapPage,updateCache:e.updateCache,deleteComment:()=>{e.setComments(e.comments.filter(e=>e.id!=t.id)),e.updateCache(e.post.id,{...e.post,expand:{...e.post.expand,comments:e.comments.filter(e=>e.id!=t.id)}}),x.delete({collection:"comments",id:t.id,cacheKey:e.cacheKey})}},t.id)})):(0,r.jsxs)("div",{className:"mx-auto justify-center w-full flex mt-2 hero flex-col",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-center",children:"No Comments \uD83D\uDE22"}),(0,r.jsx)("p",{className:"text-gray-500 text-sm  text-center prose   w-[300px] break-normal mt-6   ",children:"Be the first to comment on this post."})]})}),(0,r.jsxs)("div",{className:"flex flex-col  gap-5 w-full absolute    bottom-0   left-0   p-2  \n               ".concat("dark"==theme?"bg-black text-white":"bg-white text-black","\n          \n          ").concat(o.length>0?"sm:mt-32":"","\n          "),children:[o.length>0?(0,r.jsx)("div",{className:"flex gap-5 justify-start  p-2",children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("p",{children:"Mentions"}),(0,r.jsx)("div",{className:"flex gap-5 mt-2",children:o.length>0?o.map(e=>(0,r.jsx)("p",{onClick:()=>{},className:"text-sm  btn rounded-full btn-sm text-sky-500",children:e})):""})]})}):"",(0,r.jsxs)("div",{className:"flex flex-row  xl:hidden justify-between w-full  p-2 text-xl",children:[(0,r.jsx)("p",{onClick:()=>{a(l+"❤️")},children:"❤️"}),(0,r.jsx)("p",{onClick:()=>{a(l+"\uD83D\uDD25")},children:"\uD83D\uDD25"}),(0,r.jsx)("p",{onClick:()=>{a(l+"\uD83E\uDD74")},children:"\uD83E\uDD74"}),(0,r.jsx)("p",{onClick:()=>{a(l+"\uD83D\uDC4F")},children:"\uD83D\uDC4F"}),(0,r.jsx)("p",{onClick:()=>{a(l+"\uD83D\uDC31‍\uD83D\uDCBB")},children:"\uD83D\uDC31‍\uD83D\uDCBB"}),(0,r.jsx)("p",{onClick:()=>{a(l+"\uD83D\uDC40")},children:"\uD83D\uDC40"}),(0,r.jsx)("p",{onClick:()=>{a(l+"\uD83D\uDE02")},children:"\uD83D\uDE02"})]}),(0,r.jsx)("div",{className:"flex flex-row gap-5  sm:mb-5 mb-2 w-full items-center",children:(0,r.jsxs)("div",{className:"relative rounded  w-full  ",children:[(0,r.jsx)("input",{className:"   input justify-start  hero    \n                     ".concat("dark"==theme?"border-1 border-[#121212]":"border-slate-200 border  border-l-full","\n                      w-full rounded-full line-clamp-1  resize-none  focus:outline-none  \n                  text-sm  \n                  "),placeholder:"Reply to ".concat(null===(s=e.post.expand)||void 0===s?void 0:null===(t=s.author)||void 0===t?void 0:t.username),onChange:e=>{a(e.target.value);let t=e.target.value.match(/@\w+/g);t?i(t):i([])},value:l}),(0,r.jsx)("button",{className:"btn  \n                  ".concat("dark"==theme?"bg-black hover:bg-black border-[#121212]":"bg-white hover:bg-white border-slate-200","\n                  border-start-0 rounded-full border-l-transparent border  rounded-l-none  absolute end-0 top-0 h-full  border-l-0 "),children:l.length>0?(0,r.jsx)("p",{className:"text-sky-500",onClick:()=>{c()},children:"Post"}):(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 8.25v7.5m6-7.5h-3V12m0 0v3.75m0-3.75H18M9.75 9.348c-1.03-1.464-2.698-1.464-3.728 0-1.03 1.465-1.03 3.84 0 5.304 1.03 1.464 2.699 1.464 3.728 0V12h-1.5M4.5 19.5h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"})})})]})})]})]})})}function g(e){return(0,r.jsx)("dialog",{id:e.id+"delete",className:"dialog sm:modal xl:shadow-none md:shadow-none lg:shadow-none bg-transparent focus:outline-none",children:(0,r.jsxs)("div",{className:"modal-box xl:shadow-none lg:shadow-none md:shadow-none",children:[(0,r.jsx)("h3",{className:"font-bold text-lg",children:"Delete Post ?"}),(0,r.jsx)("p",{className:"py-4",children:"Are you sure you want to delete this post? This action cannot be undone. This will permanently delete access accross the platform."}),(0,r.jsx)("div",{className:"modal-action gap-5",children:(0,r.jsxs)("form",{method:"dialog",className:"flex gap-5",children:[(0,r.jsx)("button",{className:"text-red-500",onClick:()=>{var t;api.delete({collection:"posts",id:e.id,cacheKey:e.cacheKey}),e.setArray(e.array.filter(t=>t.id!=e.id)),null===(t=document.getElementById(e.id+"delete"))||void 0===t||t.close()},children:"Delete"}),(0,r.jsx)("button",{className:" ","data-close":!0,children:"Cancel"})]})})]})})}function w(e){return(0,r.jsx)("svg",{onClick:e.onClick,xmlns:"http://www.w3.org/2000/svg",fill:e.fill||"none",viewBox:"0 0 24 24",strokeWidth:e.width||"1.5",stroke:e.stroke||"currentColor",className:e.className,children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"})})}function f(e){return(0,r.jsx)("div",{className:"    p-2 ",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"   hover:rounded-full hover:bg-green-400 hover:bg-opacity-20   hover:text-green-600 cursor-pointer p-1 w-8 h-8 ",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3"})})})}let v=e=>{let t=new Date(e),s=(new Date().getTime()-t.getTime())/1e3,l=s/60,a=l/60,o=a/24,r=o/7,n=r/4,i=n/12;switch(!0){case s<60:return"".concat(Math.floor(s),"s");case l<60:return"".concat(Math.floor(l),"m");case a<24:return"".concat(Math.floor(a),"h");case o<7:return"".concat(Math.floor(o),"d");case r<4:return"".concat(Math.floor(r),"w");case n<12:return"".concat(Math.floor(n),"mo");case i>1:return"".concat(Math.floor(i),"y")}};function j(e){var t,s,l,a,o,i,d,h,m,u,j,b,k,N,y,S,C,P,M,L,E;let[D,B]=(0,n.useState)(e.likes),[I,A]=(0,n.useState)((null===(t=e.expand)||void 0===t?void 0:t.comments)||[]),[T,U]=(0,n.useState)(""),[z,R]=(0,n.useState)(!1),[V,H]=(0,n.useState)(!!x.authStore.model().bookmarks.includes(e.id));async function F(){!0===D.includes(x.authStore.model().id)?(B(D.filter(e=>e!=x.authStore.model().id)),await x.update({collection:"posts",cacheKey:e.cacheKey,expand:["author","likes","comments","comments.user"],id:e.id,record:{likes:D.filter(e=>e!=x.authStore.model().id)}})):(B([...D,x.authStore.model().id]),await x.update({collection:"posts",cacheKey:e.cacheKey,expand:["author","likes","comments","comments.user"],id:e.id,record:{likes:[...D,x.authStore.model().id]}}))}return(0,n.useRef)(!1),(0,r.jsxs)("div",{id:e.id,className:"xl:mt-0 w-full h-fit  relative  xl:p-3 \n        ".concat("dark"==theme?"text-white":"text-black","\n        ").concat("view"==e.currentPage?"p-2 xl:p-0":"","\n        xl:mb-0 mb-6\n        ").concat(e.isLast?"mb-[7rem]":"","\n        ").concat("user"!==e.page&&"bookmarks"!==e.page&&"home"!==e.page?"xl:p-5  ":"home"==e.page?"xl:p-5  ":""),children:[e.pinned&&"user"==e.page&&e.params.user==e.author?(0,r.jsxs)("div",{className:"flex hero   gap-5 mb-5",children:[(0,r.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"w-4 h-4\n              ".concat("dark"==theme?"fill-white":"fill-black","\n        "),children:(0,r.jsx)("g",{children:(0,r.jsx)("path",{d:"M7 4.5C7 3.12 8.12 2 9.5 2h5C15.88 2 17 3.12 17 4.5v5.26L20.12 16H13v5l-1 2-1-2v-5H3.88L7 9.76V4.5z"})})}),"Pinned"]}):"",(0,r.jsxs)("div",{className:"flex   justify-between",children:[(0,r.jsx)(p,{id:e.id+"comments",comments:I,post:e,setComments:A,cacheKey:e.cacheKey,setParams:e.setParams,swapPage:e.swapPage,updateCache:e.updateCache}),(0,r.jsxs)("div",{className:"flex flex-row  gap-2   ",children:[(null===(s=e.expand)||void 0===s?void 0:s.author.avatar)?(0,r.jsx)("img",{onClick:()=>{e.setParams({user:e.author}),e.swapPage("user")},src:x.cdn.url({collection:"users",file:null===(l=e.expand.author)||void 0===l?void 0:l.avatar,id:null===(a=e.expand.author)||void 0===a?void 0:a.id}),alt:"profile",className:"rounded object-cover w-12 h-12 cursor-pointer"}):(0,r.jsx)("div",{className:"avatar placeholder",children:(0,r.jsx)("div",{onClick:()=>{e.setParams({user:e.author}),e.swapPage("user")},className:"bg-base-200 text-black rounded w-12 h-12 avatar cursor-pointer   ",children:(0,r.jsx)("span",{className:"text-2xl",children:null===(o=e.expand.author)||void 0===o?void 0:o.username.charAt(0).toUpperCase()})})}),(0,r.jsx)("div",{className:"flex flex-col   heros",children:(0,r.jsxs)("div",{className:"flex flex-row h-0 mt-2 gap-2 hero",children:[(0,r.jsx)("p",{onClick:()=>{e.setParams({user:e.author}),e.swapPage("user")},children:(0,r.jsx)("span",{className:"capitalize font-bold cursor-pointer",children:null===(i=e.expand.author)||void 0===i?void 0:i.username})}),(0,r.jsxs)("p",{className:"hover:underline opacity-50 text-sm md:hidden sm:hidden ",children:["@",null===(d=e.expand.author)||void 0===d?void 0:d.username]}),(null===(h=e.expand.author)||void 0===h?void 0:h.validVerified)?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 fill-blue-500 text-white h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})}):"",(null===(m=e.expand.author)||void 0===m?void 0:m.isDeveloper)?(0,r.jsx)("div",{className:"tooltip    rounded tooltip-left","data-tip":"Postr Developer",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4   h-4",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z"})})}):"",(null===(u=e.expand.author)||void 0===u?void 0:u.postr_plus)?(0,r.jsx)("div",{className:"tooltip tooltip-middle cursor-pointer","data-tip":"Subscriber since ".concat(new Date(null===(j=e.expand.author)||void 0===j?void 0:j.plus_subscriber_since).toLocaleDateString()),children:(0,r.jsx)("span",{className:"badge badge-outline badge-sm rounded-full  border-blue-500 z-[-1] text-sky-500",children:"Postr+ Sub"})}):"","\xb7",(0,r.jsx)("span",{className:"text-sm",children:v(e.created)}),(0,r.jsx)("div",{className:"flex gap-2   absolute end-2 ",children:(0,r.jsxs)("div",{className:"dropdown dropdown-left",children:[(0,r.jsx)("div",{tabIndex:0,role:"button",className:"m-1",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM12.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM18.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"})})}),(0,r.jsxs)("ul",{tabIndex:0,style:{borderRadius:"10px",border:"dark"==theme?"1px solid #2d2d2d":"1px solid #f9f9f9"},className:"dropdown-content menu bg-base-100 rounded-box font-bold z-[1] w-64 p-2 shadow-xl",children:[(null===(b=e.expand)||void 0===b?void 0:b.author)&&e.expand.author.id==x.authStore.model().id?(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"text-red-500 flex hero gap-2",onClick:()=>{var t;null===(t=document.getElementById(e.id+"delete"))||void 0===t||t.showModal()},children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),"Delete"]})}):"",(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"hero flex gap-2",onClick:()=>{var t;null===(t=document.getElementById(e.id+"embed"))||void 0===t||t.showModal()},children:[(0,r.jsx)("svg",{className:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 6.75 22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3-4.5 16.5"})}),"Embed Post"]})}),(null===(k=e.expand)||void 0===k?void 0:k.author)&&e.expand.author.id!==x.authStore.model().id&&(0,r.jsx)("li",{children:x.authStore.model().blocked.includes(e.author)?(0,r.jsxs)("a",{className:"hero flex gap-2",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"})}),"Unblock @",null===(C=e.expand)||void 0===C?void 0:null===(S=C.author)||void 0===S?void 0:S.username]}):(0,r.jsxs)("a",{className:"hero flex gap-2",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"})}),"Block @",null===(y=e.expand)||void 0===y?void 0:null===(N=y.author)||void 0===N?void 0:N.username]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"hero flex gap-2",children:[(0,r.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",fill:"currentColor",className:"cursor-pointer   w-4 h-4  ",children:(0,r.jsx)("g",{children:(0,r.jsx)("path",{d:"M8.75 21V3h2v18h-2zM18 21V8.5h2V21h-2zM4 21l.004-10h2L6 21H4zm9.248 0v-7h2v7h-2z"})})}),"View Post Engagement"]})}),(null===(P=e.expand)||void 0===P?void 0:P.author)&&e.expand.author.id==x.authStore.model().id?(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"hero flex gap-2",onClick:()=>{e.pin(e.id)},children:[(0,r.jsx)("svg",{fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",className:"w-4 h-4  ",children:(0,r.jsx)("g",{children:(0,r.jsx)("path",{d:"M7 4.5C7 3.12 8.12 2 9.5 2h5C15.88 2 17 3.12 17 4.5v5.26L20.12 16H13v5l-1 2-1-2v-5H3.88L7 9.76V4.5z"})})}),e.pinned?"Unpin":"Pin"]})}):"",(null===(M=e.expand)||void 0===M?void 0:M.author)&&e.expand.author.id==x.authStore.model().id&&(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"hero flex gap-2",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 0 1-.923 1.785A5.969 5.969 0 0 0 6 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337Z"})}),"Who can reply"]})})]})]})})]})})]})]}),(0,r.jsxs)("div",{className:"mt-3 mb-4 ",children:[(0,r.jsx)("p",{style:{cursor:"pointer"},onClick:()=>{e.setParams({post:e,type:"posts"}),e.swapPage("view"),window.history.pushState({},"","/?view=status&id="+e.id+"&type=posts")},className:"mt-2",ref:t=>{t&&e.content&&(t.innerHTML=e.content)}}),e.file.length>0?(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("div",{className:" w-full \n           ".concat(e.file.length>2?"grid grid-cols-2 gap-2":e.file.length>1?"grid grid-cols-2 gap-2":"","\n            col-span-2 grid-flow-dense  "),children:e.file.map((t,s)=>(0,r.jsx)("img",{onClick:()=>{var t;null===(t=document.getElementById(e.id+"imageViewer"+s))||void 0===t||t.showModal()},className:" w-full object-cover\n    \n                    ".concat(e.file.length<2?"rounded  h-96":"border h-64     border-[#f9f9f9]  rounded","\n                    \n                     ").concat(e.file.length>2&&s==e.file.length-1?"col-span-2":"","\n                     \n                    \n                    "),src:x.cdn.url({id:e.id||e.params.id,collection:"posts",file:t}),alt:"image"}))})}):"",(0,r.jsxs)("div",{className:"flex    mt-5",children:[(0,r.jsxs)("div",{className:"w-fit flex gap-2  hero",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"\n            hover:rounded-full hover:bg-rose-500 hover:bg-opacity-20 hover:p-2   active:p-1  w-6 h-6 hover:text-rose-500\n            cursor-pointer ".concat(D.includes(x.authStore.model().id)?"fill-rose-500 text-rose-500":""),onClick:e=>{console.log("clicked"),F()},children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),D.length]}),(0,r.jsxs)("div",{className:"flex gap-2 hero  p-2 w-fit ",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"cursor-pointer hover:rounded-full hover:bg-sky-500 hover:bg-opacity-20 p-1   w-8 h-8 hover:text-sky-500  ",onClick:()=>{var t;null===(t=document.getElementById(e.id+"comments"))||void 0===t||t.showModal()},children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 01-.923 1.785A5.969 5.969 0 006 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337z"})}),I.length]}),(0,r.jsx)(f,{originalAuthor:null===(E=e.expand)||void 0===E?void 0:null===(L=E.author)||void 0===L?void 0:L.username,originalPost:e,postID:e.id,cacheKey:e.cacheKey}),(0,r.jsx)("span",{className:"tooltip tooltip-bottom","data-tip":"Post Views",children:(0,r.jsxs)("div",{className:"w-fit p-2 hero flex",children:[(0,r.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"cursor-pointer hover:rounded-full hover:bg-sky-500 hover:bg-opacity-20  p-1  w-7 h-7 hover:p-2 hover:text-sky-500\n                ".concat("dark"==theme?"fill-white":"fill-black","\n                "),children:(0,r.jsx)("g",{children:(0,r.jsx)("path",{d:"M8.75 21V3h2v18h-2zM18 21V8.5h2V21h-2zM4 21l.004-10h2L6 21H4zm9.248 0v-7h2v7h-2z"})})}),(0,r.jsx)("span",{children:e.views.length})]})}),(0,r.jsxs)("div",{className:"absolute end-5 flex  gap-2",children:[(0,r.jsx)("div",{className:"w-fit p-2 hero flex",children:(0,r.jsx)("span",{className:"tooltip tooltip-bottom","data-tip":"share",children:(0,r.jsx)("svg",{onClick:()=>{navigator.share({title:e.expand.author.username+" on Postr ",text:e.content.slice(0,100),url:"https://embedify-v1.vercel.app/embed/posts/".concat(e.id,"/meta")})},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"cursor-pointer hover:rounded-full hover:bg-sky-500 hover:bg-opacity-20  p-1 w-7   h-7 hover:text-sky-500",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})})})}),(0,r.jsx)("div",{className:"w-fit p-2 hero flex",children:(0,r.jsx)(w,{id:e.id,className:"\n            cursor-pointer hover:rounded-full hover:bg-sky-500 hover:bg-opacity-20  p-1  w-7 h-7 hover:p-2 hover:text-sky-500\n            ".concat(V?"fill-blue-500 text-blue-500":""),onClick:()=>{V?(x.update({collection:"users",cacheKey:"users-".concat(x.authStore.model().id),id:x.authStore.model().id,record:{bookmarks:x.authStore.model().bookmarks.filter(t=>t!=e.id)}}),x.update({collection:"posts",cacheKey:e.cacheKey,invalidateCache:["bookmarks-"+x.authStore.model().id],id:e.id,record:{bookmarks:x.authStore.model().bookmarks.filter(t=>t!=e.id)}}),x.authStore.update(),H(!1),e.deleteBookmark&&e.deleteBookmark()):(x.update({collection:"users",cacheKey:"users-".concat(x.authStore.model().id),id:x.authStore.model().id,record:{bookmarks:[...x.authStore.model().bookmarks,e.id]}}),x.update({collection:"posts",cacheKey:e.cacheKey,invalidateCache:["bookmarks-"+x.authStore.model().id],id:e.id,record:{bookmarks:[...x.authStore.model().bookmarks,e.id]}}),x.authStore.update(),H(!0))}})})]})]})]}),e.file?e.file.map((t,s)=>(0,r.jsx)(c,{id:e.id+"imageViewer"+s,height:"h-[100vw]",width:"w-[100vw]",children:(0,r.jsxs)("div",{className:"flex flex-col overflow-hidden justify-center items-center    relative  ",children:[(0,r.jsx)("svg",{onClick:()=>{var t;null===(t=document.getElementById(e.id+"imageViewer"+s))||void 0===t||t.close()},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"  bg-base-200 btn btn-sm btn-circle fixed left-2 top-2",children:(0,r.jsx)("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})}),(0,r.jsx)("img",{src:x.cdn.url({id:e.id||e.params.id,collection:"posts",file:t}),alt:e.file,className:"object-cover  cursor-pointer"})]})})):null,(0,r.jsx)(g,{id:e.id,...e}),(0,r.jsxs)("dialog",{id:e.id+"embed",className:"dialog sm:modal xl:shadow-none md:shadow-none lg:shadow-none bg-transparent focus:outline-none",children:[(0,r.jsxs)("div",{className:"modal-box xl:shadow-none lg:shadow-none md:shadow-none",children:[(0,r.jsx)("h3",{className:"font-bold text-lg",children:"Embed Post"}),(0,r.jsx)("p",{className:"py-4",children:"Embed this post on your website or blog by copying the code below."}),(0,r.jsx)("div",{className:"modal-action gap-5",children:(0,r.jsxs)("div",{className:"flex gap-5 justify-start  p-2",children:[(0,r.jsx)("input",{type:"text",className:"w-full p-2 rounded bg-base-200",value:'<iframe src="'.concat(window.location.origin,"/embed/").concat(e.id,'" width="100%" height="100%" frameborder="0"></iframe>')}),(0,r.jsx)("button",{className:"btn btn-sm btn-ghost",onClick:()=>{navigator.clipboard.writeText('<iframe src="'.concat(window.location.origin,"/embed/").concat(e.id,'" width="100%" height="100%" frameborder="0"></iframe>'))},children:"Copy"})]})})]}),(0,r.jsxs)("form",{method:"dialog",className:"flex gap-5",children:[(0,r.jsx)("textarea",{className:"w-full p-2 rounded bg-base-200",rows:5,value:'<iframe src="'.concat(window.location.origin,"/embed/").concat(e.id,'" width="100%" height="100%" frameborder="0"></iframe>')}),(0,r.jsx)("button",{className:" ","data-close":!0,children:"Close"})]})]})]},e.id)}let b=(0,n.memo)(function(e){return(0,r.jsxs)("div",{className:"flex  flex-col gap-4 w-full \n     \n    xl:p-2  lg:p-2 md:p-2\n    ".concat(e.media?"rounded h-44 p-0":"mb-16"),children:[e.media?(0,r.jsx)("div",{className:"skeleton \n      ".concat(e.className?e.className:"h-42","\n      ").concat(e.media?"rounded":"rounded-none","\n      w-full")}):null,e.hiderows?null:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,r.jsx)("div",{className:"skeleton\n    ".concat(e.page&&"home"==e.page?"w-16 h-16":" w-12 h-12","\n    rounded  shrink-0")}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)("div",{className:"skeleton h-4 w-32 "}),(0,r.jsx)("div",{className:"skeleton h-4 w-32"})]})]})})]})}),k=(0,n.memo)(function(e){let[t,s]=(0,n.useState)(!1),l=(0,n.useRef)(!1),a=(0,n.useCallback)(()=>{s(!0)},[]);return(0,n.useEffect)(()=>{if(l.current=!0,l.current){let t=new Image;t.src=e.src,t.onload=a}return()=>{l.current=!1}},[]),(0,r.jsxs)(r.Fragment,{children:[t?(0,r.jsx)("img",{onClick:()=>e.onClick?e.onClick():null,src:e.src,fetchPriority:"high",alt:e.alt,width:e.width,height:e.height,className:e.className}):(0,r.jsx)(b,{media:!0,hiderows:!0,className:e.className}),e.children?e.children:null]})});function N(){return x.authStore.model().postr_plus?(0,r.jsx)("div",{className:"justify-center  flex text-center mx-auto",children:(0,r.jsx)("h1",{children:"You are a premium member"})}):(0,r.jsx)("div",{className:"justify-center  flex text-center mx-auto",children:(0,r.jsxs)("div",{className:"justify-center flex flex-col gap-3 text-center  ",children:[(0,r.jsx)("h1",{className:"text-6xl text-sans font-bold text-center text-[#121212] mt-20",children:"Subscribe to Postr Premium"}),(0,r.jsx)("p",{className:"w-[50rem]",children:"Get access to new features before everyone, a sleek badge and heatfelt commendment for becoming a supporter of the project."})]})})}function y(e){let[t,s]=(0,n.useState)(""),[l,a]=(0,n.useState)([]),[o,i]=(0,n.useState)(!1);window.postModalParemeters;let[c,d]=(0,n.useState)([]),[h,m]=(0,n.useState)({});async function u(){let o={message:"",id:""};switch(l.length>0&&(l=l.map(async e=>{if(e.size>18e5){o.message="One or more of your images are too large",o.id=e.name,l=l.filter(e=>e.name!==o.id);return}return{name:e.name,type:e.type,size:e.size,data:await x.getAsByteArray(new Blob([e.data],{type:e.type}))}})),!0){case t.length<1:m({message:"You must enter some text"}),setTimeout(()=>{m(!1)},3e3);return;case l.length>4:alert("You can only upload 4 images");return;default:try{var r;i(!0);let o=await x.create({collection:"posts",expand:["author","likes","comments"],invalidateCache:["home-following","user-feed-".concat(x.authStore.model().id),"home-recommended"],record:{author:x.authStore.model().id,content:t,file:{isFile:!0,file:await Promise.all(l)},comments:[],likes:[],mentioned:[]}});console.log(o),e.setParams({id:o.id,type:"posts"}),e.swapPage("view"),a([]),s(""),null===(r=document.getElementById("createPost"))||void 0===r||r.close(),i(!1)}catch(e){}}}return(0,r.jsx)("dialog",{style:{borderRadius:"10px"},id:"createPost",className:"sm:modal  sm:modal-middle   p-5  xl:w-[25vw] rounded-box",children:(0,r.jsxs)("div",{style:{borderRadius:"10px"},className:"sm:modal-box ",children:[(0,r.jsxs)("div",{className:"flex hero justify-between",children:[(0,r.jsx)("p",{className:"cursor-pointer hover:text-red-500",onClick:()=>{var e;null===(e=document.getElementById("createPost"))||void 0===e||e.close()},children:"Cancel"}),(0,r.jsx)("button",{className:"text-blue-500 text-md focus:outline-none",children:"Drafts"})]}),(0,r.jsxs)("div",{className:" py-4 flex flex-col \n      ".concat(l.length>0?t.length/280>1?"h-96":"h-100":"h-32","\n      ;\n\n\n\n\n      "),style:{height:t.length>0?"auto":" "},children:[(0,r.jsxs)("div",{className:"flex flex-row      ",children:[x.authStore.model().avatar?(0,r.jsx)("img",{src:x.authStore.img(),className:"w-10 h-10 rounded-full object-cover"}):(0,r.jsx)("div",{className:"avatar placeholder",children:(0,r.jsx)("div",{className:"bg-base-300 text-black   avatar  w-10 h-10  border cursor-pointer rounded   border-white",children:(0,r.jsx)("span",{className:"text-2xl",children:x.authStore.model().username.charAt(0).toUpperCase()})})}),(0,r.jsx)("div",{className:"flex  flex-col w-full",children:(0,r.jsx)("textarea",{className:"w-full mt-2 mx-3 \n          focus:outline  \n          h-32 overflow-y-hidden\n          resize-none outline-none",placeholder:"What's happening?",onChange:e=>{s(e.target.value)},maxLength:280})})]}),(0,r.jsx)("div",{className:"scroll overflow-y-hidden",children:l.length>0&&(0,r.jsx)("div",{className:"sm:grid sm:grid-cols-2 flex flex-row flex-wrap flex-grow gap-2",children:Object.keys(l).map(e=>(console.log(c),c.find(t=>t.id==l[e].name),(0,r.jsxs)("div",{className:"relative  w-32 h-32 ",children:[(0,r.jsx)("img",{src:URL.createObjectURL(l[e]),className:" object-cover w-32 h-32 rounded-md\n                        xl:col-span-2 sm:col-span-1\n                        ".concat(c.find(t=>t.id==l[e].name)?"border-2 border-red-500 opacity-20":"","\n                        ")}),(0,r.jsx)("div",{onClick:()=>{a(l.filter(t=>t.name!==l[e].name))},className:"absolute btn btn-circle btn-sm top-1 right-1",children:"X"}),c.find(t=>t.id==l[e].name)?(0,r.jsx)("p",{ref:t=>{t&&(t.innerHTML=c.find(t=>t.id==l[e].name).message,setTimeout(()=>{d(c.filter(t=>t.id!==l[e].name))},3e3))},className:"text-red-500  absolute top-9 left-2 text-sm"}):""]})))})})]}),(0,r.jsx)("div",{className:"divider mt-0 mb-2 before:bg-[#f6f4f4] after:bg-[#fdf9f9]  after:text-slate-200"}),(0,r.jsxs)("div",{className:"flex  h-full justify-between",children:[(0,r.jsx)("input",{type:"file",id:"file-upload",className:"hidden",accept:"image/*",multiple:!0,max:4,onChange:e=>{if(Array.from(e.target.files).map(e=>{if(e.size>2e6){console.log("Too large",e.name),d(t=>[...t,{message:"\n                 Quota exceeded\n                 <br>\n                 <br>\n                This image will not be uploaded\n                ",id:e.name}]);return}}),e.target.files.length>4){m({message:"You can only upload 4 images"});return}a(Array.from(e.target.files)),e.target.value=""}}),(0,r.jsx)("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-row gap-2",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-7 h-7",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})})}),(0,r.jsxs)("p",{className:"  ",children:[t.length,"/",280]}),o?(0,r.jsx)("div",{className:"loading loading-spinner text-blue-500"}):(0,r.jsx)("button",{onClick:()=>{u()},className:"btn  btn-sm rounded-full ",children:"Post"})]})]})})}function S(e){var t,s;let[l,a]=(0,n.useState)(""),[o,i]=(0,n.useState)([]),[c,d]=(0,n.useState)([]),[h,m]=(0,n.useState)(!1);function u(){x.list({collection:"users",expand:["followers","following"],sort:"+followers",filter:'followers !~"'.concat(x.authStore.model().id,'" && id != "').concat(x.authStore.model().id,'"'),cacheKey:"relevant-people-"+x.authStore.model().id,limit:3,page:1}).then(e=>{d(e.items)})}return(0,n.useEffect)(()=>{u()},[]),(0,n.useEffect)(()=>{u()},[h]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"xl:drawer   xl:w-[auto] xl:drawer-end xl:drawer-open lg:drawer-open   ",children:[(0,r.jsx)("input",{id:"my-drawer-2",type:"checkbox",className:"drawer-toggle"}),(0,r.jsxs)("div",{className:"drawer-side",children:[(0,r.jsx)("label",{htmlFor:"my-drawer-2","aria-label":"close sidebar",className:"drawer-overlay"}),(0,r.jsxs)("ul",{className:"p-4   w-80  min-h-full   text-base-content",children:[(0,r.jsx)("li",{className:"\n              ".concat("dark"==theme?"xl:border xl:border-[#121212]":"xl:border xl:border-[#ecececd8]","  p-5 rounded-lg"),children:(0,r.jsxs)("a",{className:"w-full relative",children:[(0,r.jsx)("h1",{className:"font-bold text-lg",children:"Relevant People"}),c.map((t,s)=>(0,r.jsx)("div",{className:"flex flex-row gap-2\n                      ".concat("mt-5","\n                      "),children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[t.avatar?(0,r.jsx)("img",{src:x.cdn.url({id:t.id,collection:"users",file:t.avatar}),className:"w-10 h-10 rounded"}):(0,r.jsx)("div",{className:"avatar placeholder  ",children:(0,r.jsx)("div",{className:"bg-base-200 text-black rounded w-10 h-10   avatar    border-2   shadow   border-white",children:(0,r.jsx)("span",{className:"text-2xl",children:t.username.charAt(0).toUpperCase()||"U"})})}),(0,r.jsxs)("div",{className:"flex hero justify-between",children:[(0,r.jsxs)("span",{className:"flex flex-col gap-2",children:[(0,r.jsx)("p",{className:"cursor-pointer",onClick:()=>{e.setParams({user:t.id}),e.swapPage("user")},children:t.username}),(0,r.jsx)("p",{})]}),(0,r.jsx)("button",{onClick:()=>{x.update({collection:"users",id:t.id,cacheKey:"relevant-people-".concat(x.authStore.model().id),invalidateCache:["relevant-people-".concat(x.authStore.model().id),"user-following-".concat(x.authStore.model().id)],immediatelyUpdate:!0,expand:["followers","following","following.followers","following.following"],record:{followers:t.followers.concat(x.authStore.model().id)}}).then(e=>{console.log(e),x.update({collection:"users",id:x.authStore.model().id,invalidateCache:"user-home-".concat(x.authStore.model().id),immediatelyUpdate:!0,cacheKey:"user-".concat(x.authStore.model().id),expand:["followers","following","following.followers","following.following"],record:{following:x.authStore.model().following.concat(t.id)}}).then(e=>{x.authStore.update(),m(!h)})})},className:"btn absolute right-1 btn-sm bg-black rounded-full text-white border-none",children:t.followers.includes(x.authStore.model().id)?"Unfollow":"Follow"})]})]}),(0,r.jsx)("p",{className:"w-[200px]",children:t.bio})]})}))]})}),(0,r.jsxs)("li",{className:"flex flex-col gap-5 mt-2 p-2 text-sm",children:[(0,r.jsxs)("li",{className:"flex flex-row gap-5",children:[(0,r.jsx)("a",{className:"cursor-pointer hover:underline",children:"Terms of service"}),(0,r.jsx)("a",{href:"/information/privacy.pdf",className:"cursor-pointer hover:underline",children:"Privacy Policy"})]}),(0,r.jsxs)("li",{className:"flex flex-row gap-5",children:[(0,r.jsx)("a",{href:"",className:"cursor-pointer hover:underline",children:"Help and safety"}),(0,r.jsx)("a",{className:"cursor-pointer hover:underline",children:"Accessibility"})]}),(0,r.jsx)("li",{children:(0,r.jsxs)("div",{className:"tooltip cursor-pointer","data-tip":"Your app version",children:["pkg version:"," ",null===(s=window)||void 0===s?void 0:null===(t=s.postr)||void 0===t?void 0:t.version]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("a",{children:["\xa9 2022 - ",new Date().getFullYear()," Pascal. All rights reserved"]})})]})]})]})]})})}function C(e){let[t,s]=(0,n.useState)([]),[l,a]=(0,n.useState)(""),[o,i]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),[h,m]=(0,n.useState)([]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"xl:drawer xl:w-[auto]      xl:drawer-open lg:drawer-open  ",children:[(0,r.jsx)("input",{id:"my-drawer-3",type:"checkbox",className:"drawer-toggle"}),o?(0,r.jsx)("div",{className:"toast toast-end",children:(0,r.jsxs)("div",{className:"alert bg-red-500 bg-opacity-20",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"text-rose-500 w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})}),(0,r.jsx)("span",{children:o.message})]})}):"",(0,r.jsxs)("div",{className:"drawer-side",children:[(0,r.jsx)("label",{htmlFor:"my-drawer-3","aria-label":"close sidebar",className:"drawer-overlay"}),(0,r.jsxs)("ul",{className:"menu p-2  w-64  flex flex-col gap-5 min-h-full  text-base-content",children:[(0,r.jsx)("li",{className:"hover:bg-transparent",children:(0,r.jsx)("a",{className:"hover:bg-transparent focus:bg-transparent",children:(0,r.jsx)("img",{src:"/icons/icon-blue.jpg",className:"rounded",width:40,height:40})})}),(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"text-xl  rounded-full focus:bg-none ".concat("home"==e.currentPage?"font-semibold text-blue-500":""),onClick:()=>{e.swapPage("home")},children:[(0,r.jsx)("svg",{className:"\n                     w-7 h-7\n                     cursor-pointer\n                      ".concat("home"==e.currentPage?"fill-blue-500":"fill-white stroke-black ","\n                     "),xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",strokeWidth:1.5,id:"home",children:(0,r.jsx)("path",{d:"M6.63477851,18.7733424 L6.63477851,15.7156161 C6.63477851,14.9350667 7.27217143,14.3023065 8.05843544,14.3023065 L10.9326107,14.3023065 C11.310188,14.3023065 11.6723007,14.4512083 11.9392882,14.7162553 C12.2062757,14.9813022 12.3562677,15.3407831 12.3562677,15.7156161 L12.3562677,18.7733424 C12.3538816,19.0978491 12.4820659,19.4098788 12.7123708,19.6401787 C12.9426757,19.8704786 13.2560494,20 13.5829406,20 L15.5438266,20 C16.4596364,20.0023499 17.3387522,19.6428442 17.9871692,19.0008077 C18.6355861,18.3587712 19,17.4869804 19,16.5778238 L19,7.86685918 C19,7.13246047 18.6720694,6.43584231 18.1046183,5.96466895 L11.4340245,0.675869015 C10.2736604,-0.251438297 8.61111277,-0.221497907 7.48539114,0.74697893 L0.967012253,5.96466895 C0.37274068,6.42195254 0.0175522924,7.12063643 0,7.86685918 L0,16.568935 C0,18.4638535 1.54738155,20 3.45617342,20 L5.37229029,20 C6.05122667,20 6.60299723,19.4562152 6.60791706,18.7822311 L6.63477851,18.7733424 Z",transform:"translate(2.5 2)"})}),"Home"]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"text-lg  rounded-full",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"      w-7 h-7   cursor-pointer     hover:fill-black hover:text-black         ",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),"Notifications"]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"text-lg  rounded-full",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"   w-7 h-7",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})}),"Explore"]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"text-xl  rounded-full rounded-full\n                  ".concat("user"==e.currentPage&&e.params.user.username==x.authStore.model().username?"font-semibold text-blue-500":"","\n                  "),onClick:()=>{e.setParams({user:x.authStore.model().id}),e.swapPage("user")},children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"\n                   w-7 h-7\n                   ".concat("user"==e.currentPage&&e.params.user.username==x.authStore.model().username?"fill-blue-500":"","\n                  "),children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})}),"Profile"]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"text-lg  rounded-full",onClick:()=>{e.swapPage("collections")},children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-7 h-7",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M6 4.75A.75.75 0 0 1 6.75 4h10.5a.75.75 0 0 1 0 1.5H6.75A.75.75 0 0 1 6 4.75ZM6 10a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H6.75A.75.75 0 0 1 6 10Zm0 5.25a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H6.75a.75.75 0 0 1-.75-.75ZM1.99 4.75a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v.01a1 1 0 0 1-1 1h-.01a1 1 0 0 1-1-1v-.01ZM1.99 15.25a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v.01a1 1 0 0 1-1 1h-.01a1 1 0 0 1-1-1v-.01ZM1.99 10a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v.01a1 1 0 0 1-1 1h-.01a1 1 0 0 1-1-1V10Z",clipRule:"evenodd"})}),"Collections"]})}),(0,r.jsx)("li",{className:"text-lg  rounded-full",children:(0,r.jsxs)("a",{className:" rounded-full",onClick:()=>{document.getElementById("postr_plus").showModal()},children:[(0,r.jsx)("img",{src:"/icons/icon-blue.jpg",className:"rounded w-7 h-7"}),(0,r.jsx)("p",{children:"Premium"})]})}),(0,r.jsx)("li",{className:"text-lg  rounded-full  text-start hover:outline-none  hover:text-lg  hover:justify-start hover:rounded-full",children:(0,r.jsxs)("a",{className:" rounded-full",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-7 h-7",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),"Messages"]})}),(0,r.jsx)("button",{onClick:()=>{document.getElementById("createPost").showModal()},className:"btn rounded-full  text-lg hero btn-ghost  hover:bg-blue-500 focus:bg-blue-500 bg-blue-500 text-white ",children:(0,r.jsx)("p",{children:"Post"})})]})]})]}),(0,r.jsx)(y,{...e}),(0,r.jsx)("dialog",{id:"postr_plus",className:"modal max-w-[100vw] max-h-[100vh] w-screen h-screen  ",children:(0,r.jsx)("div",{className:"modal-box w-screen h-screen max-w-[100vw] max-h-[100vh] rounded-none",children:(0,r.jsxs)("div",{className:"flex flex-col bg-gradient-to-t fixed top-0 left-0 from-slate-50 to-blue-100 w-full h-full",children:[(0,r.jsx)("span",{className:"cursor-pointer absolute top-5 left-5  rounded-full ",onClick:()=>{var e;null===(e=document.getElementById("postr_plus"))||void 0===e||e.close()},children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-7 h-7",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})})}),(0,r.jsx)(N,{})]})})})]})}function P(e){var t,s,l;let[a,o]=(0,n.useState)([]),[m,u]=(0,n.useState)(null),[p,g]=(0,n.useState)(null===(t=e.params.user)||void 0===t?void 0:t.banner),[w,f]=(0,n.useState)(1),[v,b]=(0,n.useState)([]),[N,y]=(0,n.useState)([]),[P,M]=(0,n.useState)(1),[L,E]=(0,n.useState)(0),[D,B]=(0,n.useState)(!0),[I,A]=(0,n.useState)("posts"),[T,U]=(0,n.useState)(null),[z,R]=(0,n.useState)(null),[V,H]=(0,n.useState)(null),[F,O]=(0,n.useState)(0),[W,K]=(0,n.useState)(!1),[_,Z]=(0,n.useState)(!1),[J,q]=(0,n.useState)(!1),Y=(0,n.useRef)(!1);(0,n.useLayoutEffect)(()=>{if(!Y.current){if(x.cacheStore.get("user-profile-".concat(e.params.user))){let t=JSON.parse(x.cacheStore.get("user-profile-".concat(e.params.user))).value;u(t),o(t.followers),g(t.banner),t.followers.map(e=>{x.authStore.model().following.includes(e.id)&&q(!0)});return}x.read({id:e.params.user,collection:"users",cacheKey:"user-profile-".concat(e.params.user),expand:["followers","following","following.followers"]}).then(t=>{x.cacheStore.set("user-profile-".concat(e.params.user),t,12e4),u(t),console.log(t.followers),o(t.followers),K(!1),g(t.banner),t.followers.map(e=>{x.authStore.model().following.includes(e.id)&&q(!0)}),document.title="".concat(t.username," (@").concat(t.username,") | Postr")})}},[e.params.user]);let[$,G]=(0,n.useState)(!0),Q=(0,n.useRef)(null),X=(0,n.useRef)(null),ee=(0,n.useRef)(!1);function et(e){A(e),"collections"!==e&&(f(1),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;G(!0);let s="posts"===e?'author.id ="'.concat(m.id,'"'):"likes"===e?'likes~"'.concat(m.id,'" && author.id != "').concat(m.id,'"'):"media"===e?'author.id ="'.concat(m.id,'" && file:length > 0  '):"";f(1),b([]),G(!0),x.list({collection:"posts"===e||"likes"===e?"posts":"media"===e?"posts":"",limit:10,filter:s,cacheKey:"user-feed-".concat(e,"-").concat(t,"-").concat(m.id),expand:["author","comments.user","user","post","post.author","author.followers","author.following","author.following.followers","author.following.following","likes"],page:1,sort:"posts"!==e?"-created":"-pinned, -created"}).then(t=>{"media"===e&&(t.items=t.items.filter(e=>e.file.length>0)),b(t.items),M(t.totalPages),E(t.totalItems),B(!0),setTimeout(()=>{G(!1)},"media"===I?1200:500)})}(e))}async function es(){let t={};switch(!0){case m.username!==x.authStore.model().username&&m.username.length<3:case m.username!==x.authStore.model().username&&null==m.username.match(/^[a-zA-Z0-9_]*$/):try{if(await x.checkName(m.username)){alert("Username already exists.");return}}catch(e){console.log(e)}break;case 0!=m.bio.length&&m.bio.length<5:alert("Bio must be at least 10 characters");break;case 0!=m.social.length&&m.social.length<10:alert("Social links must be at least 10 characters")}m.username!==e.params.user.username&&(t.username=m.username),m.bio!==e.params.user.bio&&(t.bio=m.bio),m.location!==e.params.user.location&&(t.location=m.location),m.social!==e.params.user.social&&(t.social=m.social),null!==z&&(t.banner={isFile:!0,update:!0,file:{data:await x.getAsByteArray(z),size:V.size,name:V.name,type:V.type}}),null!==T&&(t.avatar={isFile:!0,update:!0,file:{data:await x.getAsByteArray(T),size:T.size,name:T.name,type:T.type},name:T.name,type:T.type});try{var s;if(Object.keys(t).length>0){Z(!0);let e=await x.update({collection:"users",id:m.id,immediatelyUpdate:!0,invalidateCache:["user-profile-".concat(m.id)],record:t,cacheKey:"user-profile-".concat(x.authStore.model().id),expand:["followers","following","following.followers","following.following"]});x.cacheStore.delete("user-profile-".concat(x.authStore.model().id)),x.authStore.update(),u(e),g(e.banner),Z(!1)}null===(s=document.getElementById("edit-modal"))||void 0===s||s.close()}catch(e){console.log(e)}}return window.onscroll=()=>{O(window.scrollY)},(0,n.useEffect)(()=>{if(ee.current&&$){ee.current=!0;return}if(e.params.scrollTo){let t=setInterval(()=>{let s=document.getElementById(e.params.scrollTo);s&&(s.scrollIntoView({behavior:"smooth",block:"center"}),s.className="xl:mt-0 w-full    xl:p-3  xl:mb-0 mb-6   ".concat("user"!==e.page&&"bookmarks"!==e.page&&"home"!==e.page?"xl:p-5 sm:p-2":"home"==e.page?"xl:p-5  ":"","\n          animate-pulse\n          "),setTimeout(()=>{s.className="xl:mt-0 w-full    xl:p-3  xl:mb-0 mb-6   ".concat("user"!==e.page&&"bookmarks"!==e.page&&"home"!==e.page?"xl:p-5 sm:p-2":"home"==e.page?"xl:p-5  ":"")},4e3),clearInterval(t))},1e3)}return window.scrollTo({top:0,behavior:"smooth"}),x.list({collection:"posts",limit:10,filter:'author.id ="'.concat(e.params.user,'"'),cacheKey:"user-feed-".concat(I,"-").concat(w,"-").concat(e.params.user),expand:["author","comments.user","user","post","post.author","author.followers","author.following"],page:1,sort:"-pinned, -created"}).then(e=>{console.log(e),"posts"===I&&(e.items=e.items.sort((e,t)=>t.pinned-e.pinned)),b(e.items),M(e.totalPages),E(e.totalItems),B(!0),G(!1)}),()=>{ee.current=!1}},[e.params.user]),console.log(m),(0,r.jsxs)("div",{className:" relative xl:flex   lg:flex   2xl:w-[80vw]   justify-center xl:mx-auto",children:[(0,r.jsx)(C,{...e}),F>1050&&v.length>0?(0,r.jsxs)("div",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"fixed z-[999] cursor-pointer top-24 p-3 w-fit h-10  xl:top-24 border border-slate-200 shadow hover:font-bold  translate-x-0 inset-x-0  mx-auto flex hero gap-2 text-white    rounded-full bg-[#43b1f1]\n          ",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 17a.75.75 0 0 1-.75-.75V5.612L5.29 9.77a.75.75 0 0 1-1.08-1.04l5.25-5.5a.75.75 0 0 1 1.08 0l5.25 5.5a.75.75 0 1 1-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0 1 10 17Z",clipRule:"evenodd"})}),"Scroll to top"]}):null,(0,r.jsxs)("div",{className:"flex   xl:mx-24     text-md   \n       relative \n       xl:w-[35vw]\n       md:w-[80vw] flex-col ".concat("dark"==theme?"xl:border xl:border-[#121212]":"xl:border xl:border-[#f9f9f9] ","  lg:w-[50vw]  "),children:[(0,r.jsxs)("div",{className:"flex p-3 hero sticky top-0 z-[9999] ".concat("dark"===theme?"bg-black":"bg-white"," justify-between"),children:[(0,r.jsx)("div",{className:"hover:border-slate-200   btn-ghost btn btn-circle btn-sm \n        ".concat("dark"===theme?"bg-black hover:bg-black":"bg-white hover:bg-white","  \n        "),children:(0,r.jsx)("svg",{onClick:()=>{let t=e.lastPage;e.swapPage(t)},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"xl:w-6 xl:h-6 w-5 h-5 cursor-pointer   ",children:(0,r.jsx)("path",{"fill-rule":"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z","clip-rule":"evenodd"})})}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:(0,r.jsxs)("p",{className:"text-1xl ",children:["@",m&&(null==m?void 0:m.username)||"loading"]})}),(0,r.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,r.jsx)("div",{tabIndex:0,role:"button",className:"m-1",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{d:"M3 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM15.5 8.5a1.5 1.5 0 100 3 1.5 1.5 0 000-3z"})})}),(0,r.jsxs)("ul",{tabIndex:0,className:"dropdown-content menu bg-base-100 rounded-box z-[1] w-52 p-2 shadow",children:[(0,r.jsx)("li",{children:(0,r.jsx)("a",{children:"Item 1"})}),(0,r.jsx)("li",{children:(0,r.jsx)("a",{children:"Item 2"})})]})]})]}),(0,r.jsxs)("div",{className:"relative h-44 flex  mt-2 flex-col gap-4",children:[""!==p&&m?(0,r.jsx)("img",{src:x.cdn.url({id:m.id,file:p,collection:"users"}),alt:"",className:"w-full h-full sm:h-32 object-cover"}):(0,r.jsx)("div",{className:"w-full h-full bg-gray-300"}),(0,r.jsxs)("div",{className:"flex justify-between sm:mb-6 xsm:mb-6 relative w-full",children:[(0,r.jsx)("div",{className:"indicator w-24  ",children:m&&m.avatar?(0,r.jsx)("img",{src:x.cdn.url({id:m.id,file:m.avatar,collection:"users"}),alt:m.username,className:" w-24  h-24     rounded object-cover avatar  absolute bottom-[-3vh] left-2   border-2 border-double shadow   border-white"}):(0,r.jsx)("div",{className:"avatar placeholder   absolute bottom-[-3vh] left-2",children:(0,r.jsx)("div",{className:"bg-base-200 text-black rounded w-24  h-24   avatar    border-2   shadow   border-white",children:(0,r.jsx)("span",{className:"text-2xl",children:m&&m.username.charAt(0).toUpperCase()||"U"})})})}),(0,r.jsxs)("div",{className:"absolute right-2 flex gap-5 ",children:[m&&m.id!==x.authStore.model().id?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("button",{className:"btn border-none text-white hover:bg-black  btn-sm rounded-full bg-black",children:"Message"})}):"",(0,r.jsx)("button",{onClick:()=>{var e,t;m.id===x.authStore.model().id?null===(t=document)||void 0===t||null===(e=t.getElementById("edit-modal"))||void 0===e||e.showModal():!0===a.includes(x.authStore.model().id)?(o(a.filter(e=>e!=x.authStore.model().id)),x.update({collection:"users",id:m.id,cacheKey:"user-".concat(m.id),invalidateCache:["user-profile-".concat(m.id)],immediatelyUpdate:!0,expand:["followers","following","following.followers","following.following"],record:{followers:a.filter(e=>e!=x.authStore.model().id)}}).then(e=>{console.log(e),x.update({collection:"users",id:x.authStore.model().id,invalidateCache:["user-home-".concat(x.authStore.model().id)],immediatelyUpdate:!0,cacheKey:"user-".concat(x.authStore.model().id),expand:["followers","following","following.followers","following.following"],record:{following:x.authStore.model().following.filter(e=>e!=m.id)}}).then(e=>{x.authStore.update()})})):(o([...a,x.authStore.model().id]),x.update({collection:"users",id:m.id,cacheKey:"user-".concat(m.id),invalidateCache:["user-profile-".concat(m.id)],immediatelyUpdate:!0,expand:["followers","following","following.followers","following.following"],record:{followers:[...m.followers,x.authStore.model().id]}}).then(e=>{x.update({collection:"users",cacheKey:"user-".concat(x.authStore.model().id),id:x.authStore.model().id,invalidateCache:["user-home-".concat(x.authStore.model().id)],immediatelyUpdate:!0,expand:["followers","following","following.followers","following.following"],record:{following:[...x.authStore.model().following,m.id]}}).then(e=>{x.authStore.update()})}))},className:"btn border-none  \n                ".concat("dark"===theme?"hover:bg-white bg-white text-black":"hover:bg-black bg-black text-white","\n                btn-sm rounded-full  "),children:m&&m.id===x.authStore.model().id?"Edit Profile":a.includes(x.authStore.model().id)?"Unfollow":"Follow"})]})]})]}),(0,r.jsxs)("div",{className:"justify-between relative text-sm mt-[8vh] sm:mt-2 mx-4",children:[(0,r.jsxs)("div",{className:"flex w-full  hero gap-3",children:[(0,r.jsx)("p",{className:"text-2xl font-bold",children:m&&m.username||"loading"}),m&&m.isVerified?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 fill-blue-500 text-white h-8",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})}):"",m&&m.isDeveloper?(0,r.jsx)("div",{className:"tooltip    rounded tooltip-left","data-tip":"Postr Developer",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5   h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z"})})}):"",m&&m.plus_subscriber?(0,r.jsx)("div",{className:"tooltip z[-1]","data-tip":"Subscriber since ".concat(new Date(m.plus_subscriber_since).toLocaleDateString()),children:(0,r.jsx)("span",{className:"badge badge-outline badge-md text-sm border-blue-500 z-[-1] text-sky-500",children:"Postr+ Subscriber"})}):""]}),(0,r.jsxs)("p",{className:"opacity-45",children:["@",m&&m.username||"loading"]}),(0,r.jsx)("p",{className:"mt-3 tet-md w-full  ",children:m&&""!==m.bio?m.bio:"This user has not set a bio."}),(0,r.jsxs)("div",{className:"flex flex-wrap  gap-2",children:[(0,r.jsxs)("p",{className:"hero flex mt-4 gap-2 w-full",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5m-9-6h.008v.008H12v-.008zM12 15h.008v.008H12V15zm0 2.25h.008v.008H12v-.008zM9.75 15h.008v.008H9.75V15zm0 2.25h.008v.008H9.75v-.008zM7.5 15h.008v.008H7.5V15zm0 2.25h.008v.008H7.5v-.008zm6.75-4.5h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V15zm0 2.25h.008v.008h-.008v-.008zm2.25-4.5h.008v.008H16.5v-.008zm0 2.25h.008v.008H16.5V15z"})}),"Joined ",m&&new Date(m.created).toLocaleDateString()||"loading"]}),(0,r.jsx)("div",{children:m&&""!==m.location?(0,r.jsxs)("p",{className:"mt-4 hero flex gap-2 w-full",children:[(0,r.jsx)(h,{})," ",(0,r.jsx)("span",{className:"text-md cursor-pointer font-medium",children:m.location})]}):""}),(0,r.jsx)("p",{children:m&&""!==m.social?(0,r.jsxs)("p",{className:"mt-4 hero flex gap-2 w-full",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"})}),(0,r.jsx)("span",{className:"text-md cursor-pointer font-medium",children:(0,r.jsx)("span",{onClick:()=>{window.open(m.social)},className:"text-blue-500 text-md w-5/6  hover:underline",children:m.social.replace(/(^\w+:|^)\/\//,"")})})]}):""})]}),(0,r.jsxs)("div",{className:"flex gap-2 mt-2 mx-1",children:[(0,r.jsxs)("p",{className:" mt-2 text-md",children:[(0,r.jsxs)("span",{className:"font-bold",children:[" ",m&&m.following?m.following.length:0," "]}),"Following"]}),(0,r.jsxs)("p",{className:" mt-2 text-md",children:[(0,r.jsxs)("span",{className:"font-bold",children:[" ",void 0!==a?a.length:0," "]}),void 0!==a&&1===a.length?"Follower":"Followers"]})]})]}),(0,r.jsx)("div",{className:"hero w-fit flex",children:m&&(null===(s=m.expand)||void 0===s?void 0:s.followers)&&m.id!==x.authStore.model().id&&(null===(l=m.expand)||void 0===l?void 0:l.followers.length)>0?(0,r.jsxs)("div",{className:"avatar-group mx-3 -space-x-6 flex gap-8 text-sm   rtl:space-x-reverse",children:[m.expand.followers.map(e=>{if(x.authStore.model().following.includes(e.id))return(0,r.jsx)(r.Fragment,{children:e.avatar?(0,r.jsx)("div",{className:"avatar  rounded-full  ",children:(0,r.jsx)("div",{className:"w-4",children:(0,r.jsx)("img",{src:x.cdn.url({id:e.id,collection:"users",file:e.avatar}),alt:"",className:" object-cover"})})}):(0,r.jsx)("div",{className:"  placeholder avatar  rounded-full ",children:(0,r.jsx)("div",{className:"   ",children:(0,r.jsx)("span",{className:"text-2xl",children:e.username.charAt(0).toUpperCase()})})})})}),(0,r.jsx)("p",{className:" mt-1 opacity-70 hover:underline cursor-pointer",children:m&&m.expand.followers.length>1&&J?(0,r.jsxs)(r.Fragment,{children:["Followed by "," ",m.followers.map(t=>{if(x.authStore.model().following.includes(t.id))return(0,r.jsx)("a",{onClick:()=>{e.setParams({user:t.id}),e.swapPage("user")},className:"hover:underline cursor-pointer",children:t.username})})]}):""})]}):""}),(0,r.jsxs)("div",{className:"flex flex-row p-2 gap-2 justify-between    xl:border-[#f9f9f9] ",children:[(0,r.jsxs)("a",{role:"tab",onClick:()=>{"posts"!==I&&et("posts")},className:"\n         p-2  cursor-pointer  ".concat("posts"===I?"active font-bold   ":"","\n      "),children:["Posts","posts"===I?(0,r.jsx)("div",{className:" rounded-md h-1 bg-blue-500"}):""]}),(0,r.jsxs)("a",{onClick:()=>{"replies"!==I&&et("collections")},role:"tab",className:"  cursor-pointer  p-2  ".concat("replies"===I?"active  ":""),children:["Collections","collections"===I?(0,r.jsx)("div",{className:" rounded-md h-1 bg-blue-500"}):""]}),(0,r.jsxs)("a",{onClick:()=>{"media"!==I&&et("media")},role:"tab",className:"\n         p-2  cursor-pointer ".concat("media"===I?"active font-bold  ":"","\n      "),children:["Media","media"===I?(0,r.jsx)("div",{className:" rounded-md h-1 bg-blue-500"}):""]}),(0,r.jsxs)("a",{onClick:()=>{"likes"!==I&&et("likes")},role:"tab",className:"\n       p-2  cursor-pointer ".concat("likes"===I?"active font-bold":"","\n      "),children:["Likes","likes"===I?(0,r.jsx)("div",{className:" rounded-md h-2 bg-blue-500"}):""]})]}),(0,r.jsx)(d.Z,{hasMore:D,dataLength:v.length,next:function(){if(console.clear(),!0==w>=P){console.log("no more"),B(!1);return}"collections"!==I&&x.list({cacheKey:"user-feed-".concat(I,"-").concat(w+1,"-").concat(m.id),collection:"posts"===I?"posts":"likes"===I?"posts":"replies"===I?"comments":"media"===I?"posts":"",limit:10,filter:"posts"===I?'author.id ="'.concat(m.id,'" && pinned=false'):"likes"===I?'likes?~"'.concat(m.id,'" && author.id != "').concat(m.id,'"'):"replies"===I?'user.id="'.concat(m.id,'" &&post.author.id!="').concat(m.id,'"'):"media"===I?'file:length > 0  && author.id ="'.concat(m.id,'"'):"",expand:["author","comments.user","user","post","post.author","author.followers","author.following","author.following.followers","author.following.following","likes"],sort:"-created",page:w+1}).then(e=>{"media"===I&&(e.items=e.items.filter(e=>e.file.length>0)),b([...v,...e.items]),B(!0),f(w+1)})},loader:"",children:(0,r.jsx)("div",{className:"media"!==I||$?"flex flex-col  xl:p-0 lg:p-0 md:p-0 p-4 mb-24 ":"grid grid-cols-3 gap-3   mb-24 xl:p-3 lg:p-3 md:p-3  sm:p-3 p-2",children:$?(0,r.jsx)("div",{className:"mx-auto W-full flex justify-center",children:(0,r.jsx)("span",{className:"loading loading-spinner-large loading-spinner mt-5 text-blue-600"})}):"posts"===I||"likes"===I?v.length>0?v.map((t,s)=>(0,r.jsx)("div",{style:{border:"dark"===theme?"1px solid #121212":"1px solid #f9f9f9"},className:s===v.length-1?"sm:mt-3":"",children:(0,n.createElement)(j,{...t,user:m,page:e.page,params:e.params,swapPage:e.swapPage,setParams:e.setParams,cacheKey:m&&"user-feed-posts-".concat(w,"-").concat(m.id),key:t.id,setArray:b,array:v,pin:e=>{let l=v.find(t=>t.id===e);if(l.pinned){l.pinned=!1;let e=[...v];for(var a in e[s]=l,e=e.sort((e,t)=>new Date(t.created).getTime()-new Date(e.created).getTime()))e[a].pinned&&(e.unshift(e.splice(a,1)[0]),e=e.sort((e,t)=>{if(e.pinned&&t.pinned)return new Date(t.created).getTime()-new Date(e.created).getTime()}));x.update({collection:"posts",id:t.id,record:{pinned:!1},cacheKey:"user-feed-posts-".concat(w,"-").concat(m.id)}),b(e);return}l.pinned=!0;let o=[...v];o[s]=l,o.unshift(o.splice(s,1)[0]),x.update({collection:"posts",id:e,record:{pinned:!0},cacheKey:"user-feed-posts-".concat(w,"-").concat(m.id)}),b(o)},currentPage:w})})):(0,r.jsx)("div",{children:(0,r.jsxs)("p",{className:"text-center text-xl font-bold mt-10",children:[m&&m.id===x.authStore.model().id?"You":m&&m.username,"posts"===I?" haven't posted anything yet.":"likes"===I?" hasn't liked anything yet.":""]})}):"collections"===I?v.length>0?(0,r.jsx)("div",{className:"mt-5",children:"Coming Soon"}):0===v.length?(0,r.jsx)("div",{className:"text-center text-lg mt-10",children:(0,r.jsx)("p",{className:"font-extrabold ",children:x.authStore.model().id===m.id?"You haven't replied to anything yet.":"@".concat(m.username," hasn't replied to anyone yet")})}):"":"media"===I?v.length>0?v.map(e=>(0,r.jsx)(r.Fragment,{children:e.file.map(t=>{let s=t.replace(/\./g,"");return(0,r.jsxs)(r.Fragment,{children:[" ",(0,r.jsx)(k,{onClick:()=>{var e;null===(e=document.getElementById(s))||void 0===e||e.showModal()},src:x.cdn.url({id:e.id,collection:"posts",file:t}),height:"100%",width:"100%",alt:"",className:"w-full cursor-pointer   rounded-md h-44 object-cover"}),(0,r.jsx)(c,{id:s,height:"h-[100vh]",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center h-full bg-[#121212]  relative",children:[(0,r.jsx)("svg",{onClick:()=>{var e;null===(e=document.getElementById(s))||void 0===e||e.close()},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-6 h-6 cursor-pointer text-white absolute left-2 top-2",children:(0,r.jsx)("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})}),(0,r.jsx)("img",{src:x.cdn.url({id:e.id,collection:"posts",file:t}),alt:t,className:" w-full   object-contain mt-2 cursor-pointer"})]})})]})})})):Array.from(Array(10).keys()).map(e=>(0,r.jsx)(k,{src:"",height:"100%",width:"100%",alt:"",className:"w-full   rounded-md h-44 object-cover"})):""})}),(0,r.jsxs)(c,{style:{borderRadius:"1rem"},id:"edit-modal",className:"".concat("dark"===theme?"bg-black":"bg-white","  p-0  rounded-lg  xl:rounded-box xl:max-w-[75vw] xl:h-[75vh] h-screen"),height:"xl:h-[75vh] xl:rounded-box xl:max-w-[75vw] h-screen",children:[(0,r.jsx)("div",{className:"mx-2 mt-3    p-0",children:(0,r.jsxs)("div",{className:"flex hero justify-between",children:[(0,r.jsx)("svg",{onClick:()=>{var e;null===(e=document)||void 0===e||e.getElementById("edit-modal").close()},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 cursor-pointer   ",children:(0,r.jsx)("path",{"fill-rule":"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z","clip-rule":"evenodd"})}),(0,r.jsx)("p",{className:"text-1xl mx-8 mr-0",children:"Edit Profile"}),_?(0,r.jsx)("span",{className:"loading  loading-sm loading-spinner  text-blue-600"}):(0,r.jsx)("button",{className:"btn btn-sm rounded-full bg-black text-white ",onClick:()=>{console.log("saving"),es()},children:"Save"})]})}),(0,r.jsx)("input",{type:"file",className:"hidden",id:"change-avatar",name:"change-avatar",accept:"image/*",onChange:e=>{if(console.log(e.target.files),e.target.files){let t=e.target.files[0];if(U(t),t){let e=new FileReader;e.onload=e=>{var t;X.current.src=null===(t=e.target)||void 0===t?void 0:t.result},e.readAsDataURL(t)}}}}),(0,r.jsx)("input",{type:"file",className:"hidden",id:"change-banner",name:"change-banner",accept:"image/*",onChange:e=>{if(e.target.files){let t=e.target.files[0];R(new Blob([t],{type:t.type})),H(t);let s=new FileReader;s.onload=e=>{var t;Q.current.src=null===(t=e.target)||void 0===t?void 0:t.result},s.readAsDataURL(t)}}}),(0,r.jsxs)("div",{className:"flex flex-col croll   relative mt-4",children:[(0,r.jsxs)("div",{className:"relative h-24 mb-6   flex flex-col w-full gap-2",children:[m&&""!==m.banner||m&&null!==z?(0,r.jsxs)("div",{className:"relative h-[9rem]",children:[(0,r.jsx)("img",{src:null!==z?URL.createObjectURL(z):x.cdn.url({id:m.id,file:m.banner,collection:"users"}),ref:Q,alt:"",className:"w-full h-full object-cover"}),(0,r.jsx)("div",{className:"absolute btn btn-circle bg-[#030303] bg-opacity-25  inset-x-0 mx-auto translate-x-0   left-[-2vw] text-white top-[30%]",children:(0,r.jsx)("label",{htmlFor:"change-banner",onClick:()=>{document.getElementById("change-banner").click()},children:(0,r.jsx)("button",{children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6  ",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]})})})})]}):(0,r.jsxs)("div",{className:"relative h-32",children:[(0,r.jsx)("div",{className:"w-full h-36 object-cover bg-gray-300 "}),(0,r.jsx)("div",{className:"absolute btn btn-circle bg-[#030303] bg-opacity-25  inset-x-0 mx-auto translate-x-0   left-[-2vw] text-white top-[30%]",children:(0,r.jsx)("label",{htmlFor:"change-banner",onClick:()=>{document.getElementById("change-banner").click()},children:(0,r.jsx)("button",{children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6  ",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]})})})})]}),m&&""!==e.params.user.avatar||m&&null!==T?(0,r.jsx)("div",{className:"absolute top-[80px] left-2",children:(0,r.jsxs)("div",{className:"relative w-32  ",children:[(0,r.jsx)("img",{src:T||x.cdn.url({id:m.id,collection:"users",file:m.avatar}),ref:X,alt:"",className:"w-20 h-20 object-cover avatar rounded  border-slate-200 border-2"}),(0,r.jsx)("label",{htmlFor:"change-avatar",onClick:()=>{document.getElementById("change-avatar").click()},children:(0,r.jsx)("div",{className:"text-white absolute btn btn-circle btn-sm bg-[#030303] bg-opacity-25 left-[25px] top-[26px] inset-x-0   translate-x-0",children:(0,r.jsx)("button",{children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6  ",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]})})})})]})}):(0,r.jsx)("div",{className:"absolute top-[80px] left-5",children:(0,r.jsxs)("div",{className:"relative w-32  ",children:[(0,r.jsx)("div",{className:"w-20 h-20 object-cover bg-gray-300 avatar rounded border-slate-200 border-2"}),(0,r.jsx)("label",{htmlFor:"change-avatar",onClick:()=>{document.getElementById("change-avatar").click()},children:(0,r.jsx)("div",{className:"text-white absolute btn btn-circle btn-sm bg-[#030303] bg-opacity-50 left-[25px] top-[26px] inset-x-0   translate-x-0",children:(0,r.jsx)("button",{children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6  ",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z"})]})})})})]})})]}),(0,r.jsx)("div",{className:"mt-12  p-3 sm:scroll ",children:(0,r.jsxs)("div",{className:"relativ  flex flex-col gap-3  ",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{children:"Username"}),(0,r.jsx)("textarea",{className:"w-full h-12 p-2  mt-2 resize-none outline-none bg-transparent textarea   border-slate-200",placeholder:"Bio",...m?{value:m.username}:{},defaultValue:e.params.user.username,onChange:e=>{if(e.target.value.length>=15){u({...m,username:e.target.value.slice(0,15)});return}u({...m,username:e.target.value})}})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{children:"Bio"}),(0,r.jsx)("textarea",{className:"w-full h-20 p-2 mt-2 resize-none outline-none bg-transparent textarea   border-slate-200",placeholder:"Bio",value:m&&m.bio,onChange:e=>{if(e.target.value.length>=160){u({...m,bio:e.target.value.slice(0,160)});return}u({...m,bio:e.target.value})},defaultValue:e.params.user.bio}),(0,r.jsxs)("p",{className:"absolute bottom-4 right-4 text-xs opacity-50",children:[m&&m.bio.length,"/",160]})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{children:"Location"}),(0,r.jsx)("textarea",{className:"w-full h-12 p-2 mt-2 resize-none outline-none bg-transparent textarea   border-slate-200",placeholder:"Location",value:m&&m.location,onChange:e=>{if(e.target.value.length>=30){u({...m,location:e.target.value.slice(0,30)});return}u({...m,location:e.target.value})},defaultValue:e.params.user.location}),(0,r.jsxs)("p",{className:"absolute bottom-4 right-4 text-xs opacity-50",children:[m&&m.location.length,"/30"]})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("label",{children:["Social"," ",(0,r.jsx)("span",{className:"text-sm opacity-50",children:"(Strafe, Twitter, Instagram, Website.)"})]}),(0,r.jsx)("textarea",{className:"w-full h-12 p-2 mt-2 resize-none outline-none bg-transparent textarea   border-slate-200",placeholder:"Social",value:m&&m.social,onChange:e=>{if(e.target.value.length>=40){u({...m,social:e.target.value.slice(0,40)});return}u({...m,social:e.target.value})},defaultValue:e.params.user.social})]})]})})]})]})]}),(0,r.jsx)(S,{...e}),(0,r.jsx)("div",{className:"xl:hidden lg:hidden md:hidden",children:(0,r.jsx)(i,{swapPage:e.swapPage})})]},e.params.user)}function M(e){return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:e.fill||"none",viewBox:"0 0 24 24",strokeWidth:e.width||1.5,stroke:e.stroke||"currentColor",className:e.className,onClick:e.onClick,children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}function L(e){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("dialog",{style:{border:"dark"==theme?"1px solid #2d2d2d":"1px solid #f9f9f9",borderRadius:"10px"},id:"logout-modal",className:" rounded-box   modal-middle \n            \n            ",children:(0,r.jsxs)("div",{style:{borderRadius:"10px",border:"dark"==theme?"1px solid #2d2d2d":"1px solid #f9f9f9"},className:"flex p-5 xl:w-[15vw] h-[45vh] xl:h-[35vh] rounded-box items-center \n             ".concat("dark"===theme?"bg-black text-white":"bg-white text-black ","\n            justify-center flex-col mx-auto"),children:[(0,r.jsx)("img",{src:"/icons/icon-blue.jpg",className:"rounded",alt:"postr logo",width:40,height:40}),(0,r.jsx)("p",{className:"font-bold text-xl mt-2",children:"Loging out of Postr?"}),(0,r.jsx)("p",{className:"text-sm mt-2",children:"You can always log back in at any time."}),(0,r.jsx)("button",{className:"btn btn-ghost rounded-full w-full  \n                ".concat("dark"===theme?"bg-white text-black":"bg-black text-white","\n                mt-5"),onClick:()=>{e.swapPage("login"),x.authStore.clear()},children:"Logout"}),(0,r.jsx)("form",{method:"dialog",className:"w-full",children:(0,r.jsx)("button",{className:"btn btn-ghost mt-5 w-full rounded-full bg-base-200 ",children:"Cancel"})})]})})})}function E(e){let[t,s]=(0,n.useState)(!1),[l,a]=(0,n.useState)(!1);return(0,r.jsxs)("div",{className:"relative xl:flex   lg:flex   2xl:w-[80vw]   justify-center xl:mx-auto    ",children:[(0,r.jsx)(C,{...e}),e.children,t&&!l?(0,r.jsx)("div",{onClick:()=>{a(!0)},className:"toast toast-end sm:toast-center  text-sm sm:hidden xsm:hidden  sm:top-0 ",children:(0,r.jsxs)("div",{className:"alert bg-[#f82d2df5] text-white  hero flex flex-row gap-2   font-bold shadow rounded-box",children:[(0,r.jsx)("span",{children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})})}),(0,r.jsxs)("p",{children:["Poor connection detected.",(0,r.jsx)("p",{children:"Likely due to your internet connection."}),(0,r.jsx)("span",{className:"text-sm",children:" Click to Dismiss"})]})]})}):"",(0,r.jsx)(S,{params:e.params,setParams:e.setParams,currentPage:e.currentPage,swapPage:e.swapPage}),(0,r.jsx)(L,{...e})]},e.key)}function D(e){var t,s;let[l,a]=(0,n.useState)(!1);(0,n.useEffect)(()=>{a(!0),window.history.pushState({},"","/")},[]);let o=(0,n.useRef)(!1),[c,h]=(0,n.useState)([]),[m,u]=(0,n.useState)(0),[p,g]=(0,n.useState)(1),[f,v]=(0,n.useState)(!1),[b,k]=(0,n.useState)((null===(t=window)||void 0===t?void 0:t.page)||"recommended"),[N,y]=(0,n.useState)(!0),[S,C]=(0,n.useState)(window.scrollY),[P,L]=(0,n.useState)(!1),[D,B]=(0,n.useState)(!1);window.addEventListener("online",e=>{e.detail.online.get("latency")>2e3?L(!0):L(!1)});let[I,A]=(0,n.useState)(!0);function T(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],window.page=e,k(e),v(!0),x.cacheStore.has("user-home-".concat(e,"-posts-1-").concat(x.authStore.model().id))){let t=JSON.parse(x.cacheStore.get("user-home-".concat(e,"-posts-1-").concat(x.authStore.model().id))).value;h(t.items),u(t.totalPages),A(!0),v(!1);return}let t="following"===e?'author.followers ?~"'.concat(x.authStore.model().id,'"'):"recommended"===e?' author !="'.concat(x.authStore.model().id,'" && author.followers !~ "').concat(x.authStore.model().id,'"'):"trending"===e?'likes:length > 5 && author.id !="'.concat(x.authStore.model().id,'" && author.followers !~"').concat(x.authStore.model().id,'"'):"";h([]),console.log(!0),console.log(t),x.list({collection:"posts",limit:10,filter:t,refresh:!0,refreshEvery:1200,cacheKey:"user-home-".concat(e,"-posts-1-").concat(x.authStore.model().id),expand:["author","comments.user","user","post","post.author","author.followers","author.following","author.following.followers","author.following.following"],page:0,sort:"-created"}).then(t=>{h(t.items),u(t.totalPages),x.cacheStore.has("user-home-".concat(e,"-posts-1-").concat(x.authStore.model().id))||x.cacheStore.set("user-home-".concat(e,"-posts-1-").concat(x.authStore.model().id),{items:t.items,totalPages:t.totalPages},1200),A(!0),v(!1)})}async function U(){let{ratelimited:e,limit:t,duration:s,used:l}=await x.authStore.isRatelimited("list");switch(!0){case e:break;case p>=m:A(!1);break;case x.cacheStore.has("user-home-".concat(b,"-posts-").concat(p+1,"-").concat(x.authStore.model().id)):h([...c,...x.cacheStore.get("user-home-".concat(b,"-posts-").concat(p+1,"-").concat(x.authStore.model().id))]),g(e=>e+1);break;default:let a="following"===b?'author.followers ?~"'.concat(x.authStore.model().id,'"'):"recommended"===b?' && author.id !="'.concat(x.authStore.model().id,'" && author.followers !~"').concat(x.authStore.model().id,'"'):"trending"===b?'likes:length > 5 && author.id !="'.concat(x.authStore.model().id,'" && author.followers !~"').concat(x.authStore.model().id,'"'):"";await x.list({collection:"posts",limit:10,page:p+1,cacheKey:"user-home-".concat(b,"-posts-").concat(p+1,"-").concat(x.authStore.model().id),filter:a,cacheTime:1200,expand:["author"],sort:"-created"}).then(e=>{x.cacheStore.set("user-home-".concat(b,"-posts-").concat(p+1,"-").concat(x.authStore.model().id),e.items,1200),h([...c,...e.items]),u(e.totalPages),g(e=>e+1)}).catch(e=>{console.log(e)})}}return(0,n.useLayoutEffect)(()=>{var e,t,s,l,a,r;if(v(!0),x.cacheStore.has("user-home-".concat(b,"-posts-1-").concat(null===(e=x.authStore.model())||void 0===e?void 0:e.id))){let e=JSON.parse(x.cacheStore.get("user-home-".concat(b,"-posts-1-").concat(null===(t=x.authStore.model())||void 0===t?void 0:t.id))).value;h(e.items),u(e.totalPages),A(!0),setTimeout(()=>{v(!1)},1e3)}else{window.onscroll=()=>{C(window.scrollY)},g(1);let e="following"===b?' author.followers ~"'.concat(null===(s=x.authStore.model())||void 0===s?void 0:s.id,'"'):"recommended"===b?' author !="'.concat(null===(l=x.authStore.model())||void 0===l?void 0:l.id,'" && author.followers !~ "').concat(null===(a=x.authStore.model())||void 0===a?void 0:a.id,'"'):"trending"===b?'likes:length > 5 && author.id !="'.concat(x.authStore.model().id,'" && author.followers !~"').concat(x.authStore.model().id,'"'):"";x.list({collection:"posts",limit:10,page:1,cacheKey:"user-home-".concat(b,"-posts-1-").concat(null===(r=x.authStore.model())||void 0===r?void 0:r.id),cacheTime:1200,filter:e,expand:["author","comments.user","author.followers","author.following","author.following.followers","author.following.following","likes"],sort:"-created"}).then(e=>{var t;x.cacheStore.set("user-home-".concat(b,"-posts-1-").concat(null===(t=x.authStore.model())||void 0===t?void 0:t.id),{totalPages:e.totalPages,items:e.items},1200),u(e.totalPages),h(e.items),v(!1)})}return document.title="Postr - ".concat(b),!x.authStore.isValid()||x.isSubscribed("posts")||x.isSubscribed("users")||(x.subscribe({collection:"posts",event:"*"},e=>{if("update"==e.event&&e.record.author.id!==x.authStore.model().id)for(var t of x.cacheStore.keys()){let l=JSON.parse(x.cacheStore.get(t)).value.items;for(var s of(console.log(l),l))s.id===e.record.id&&(s=e.record,l=l.map(e=>e.id===s.id?s:e));x.cacheStore.set(t,{totalPages:x.cacheStore.get(t).totalPages,items:l},1200)}}),x.subscribe({collection:"users",event:"*"},e=>{if("update"==e.event&&e.record.id===x.authStore.model().id)x.authStore.model(e.record);else for(var t of x.cacheStore.keys())if(t.includes("user-profile")&&t.includes(e.record.id)){console.log(t);let s=JSON.parse(x.cacheStore.get(t)).value;s=e.record,x.cacheStore.set(t,s,1200)}else t.includes("user-home")&&t.includes("following")&&e.record.followers.includes(x.authStore.model().id),x.cacheStore.delete(t)}),console.log("Subscribed to posts")),()=>{o.current=!0}},[]),(0,n.useEffect)(()=>{document.title="Postr - ".concat(b.charAt(0).toUpperCase()+b.slice(1))},[b]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(E,{...e,children:(0,r.jsxs)("div",{className:" xl:mx-24     text-md    relative  xl:w-[35vw] md:w-[50vw]    xl:text-sm md:text-sm",children:[S>250&&c.length>10?(0,r.jsxs)("div",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"fixed top-4 p-3 w-fit h-10 xl:top-[17rem]  z-[999] cursor-pointer  translate-x-0 inset-x-0  mx-auto flex hero gap-2 text-white    rounded-full bg-[#43b1f1]",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-7 h-7",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 15a.75.75 0 01-.75-.75V7.612L7.29 9.77a.75.75 0 01-1.08-1.04l3.25-3.5a.75.75 0 011.08 0l3.25 3.5a.75.75 0 11-1.08 1.04l-1.96-2.158v6.638A.75.75 0 0110 15z",clipRule:"evenodd"})}),(0,r.jsx)("div",{className:"border-none    -space-x-2  flex",children:Array.from([,,,].keys()).map(e=>{let t=c[e];return(0,r.jsx)("div",{className:"flex hero gap-2",children:(0,r.jsx)("div",{className:"avatar border-none",children:(0,r.jsx)("div",{className:"w-8",children:(0,r.jsx)("img",{src:x.cdn.url({id:null==t?void 0:t.expand.author.id,collection:"users",file:null==t?void 0:t.expand.author.avatar}),alt:"avatar",className:"rounded-full object-contain w-full h-full"})})})})})})," ",(0,r.jsx)("p",{className:"text-sm",children:"posted"})]}):"",(0,r.jsxs)("div",{style:{borderBottom:"none"},className:" xl:sticky xl:top-0       w-[100%]  xl:z-[999] flex flex-col \n            ".concat("dark"===theme?"bg-black  border-[#121212] border-2 border-b-none ":"bg-white  border   border-[#f6f4f4] bg-opacity-75 bg-white ","  \n            "),children:[(0,r.jsx)("div",{className:"flex xl:p-5 w-full sm:p-3  justify-between ",children:(0,r.jsx)("div",{className:"flex gap-2 hero",children:(0,r.jsx)("div",{className:"flex flex-col   w-full",children:(0,r.jsxs)("div",{className:"flex  justify-between gap-2 w-full",children:[(0,r.jsxs)("div",{className:"flex flex-row  gap-2  ",children:[(0,r.jsxs)("div",{className:"dropdown     ",children:[(0,r.jsx)("label",{tabIndex:0,children:(0,r.jsx)(r.Fragment,{children:(null===(s=x.authStore.model())||void 0===s?void 0:s.avatar)?(0,r.jsx)("img",{src:x.authStore.img(),alt:x.authStore.model().username,className:"rounded object-cover w-12 h-12 cursor-pointer"}):(0,r.jsx)("div",{className:"avatar placeholder",children:(0,r.jsx)("div",{className:"bg-base-300 text-black   avatar  w-16 h-16   border cursor-pointer rounded   border-white",children:(0,r.jsx)("span",{className:"text-2xl",children:x.authStore.model().username.charAt(0).toUpperCase()})})})})}),(0,r.jsxs)("ul",{tabIndex:0,style:{border:"dark"===theme?"1px solid #2d2d2d":"1px solid #f9f9f9",borderRadius:"10px"},className:"dropdown-content z-[1] menu   w-[16rem] shadow bg-base-100  rounded ",children:[(0,r.jsx)("li",{children:(0,r.jsx)("a",{className:"rounded-full",onClick:()=>{e.setParams({user:x.authStore.model().id}),e.swapPage("user")},children:"View Profile"})}),x.authStore.model().postr_plus?(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"rounded-full",children:["Your benefits",(0,r.jsx)("span",{className:"badge badge-outline border-blue-500 text-blue-500",children:"++"})]})}):"",(0,r.jsx)("li",{children:(0,r.jsx)("a",{className:"rounded-full",children:"Set Status"})}),(0,r.jsx)("li",{children:(0,r.jsxs)("a",{className:"rounded-full",onClick:()=>{document.getElementById("logout-modal").showModal()},children:["Logout"," ",(0,r.jsxs)("span",{className:"font-bold",children:[" ","@",x.authStore.model().username]})]})})]})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("p",{className:"font-bold ",children:x.authStore.model().username}),(0,r.jsxs)("p",{className:"text-lg",children:["@",x.authStore.model().username+x.authStore.model().id.substring(0,4)]})]})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)(w,{className:"w-7 h-7 cursor-pointer",onClick:()=>{e.swapPage("bookmarks")}}),(0,r.jsx)(M,{onClick:()=>{e.swapPage("settings")},className:"w-7 h-7 cursor-pointer"})]})]})})})}),P&&!D?(0,r.jsx)("div",{className:"toast p-2  xl:hidden lg:hidden md:hidden toast-end relative sm:toast-center  text-sm ",onClick:()=>{B(!0)},children:(0,r.jsxs)("div",{className:"alert bg-[#f82d2df5] text-white  hero flex flex-row gap-2   font-bold shadow rounded-box",children:[(0,r.jsx)("span",{children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})})}),(0,r.jsxs)("p",{children:["Poor connection detected.",(0,r.jsx)("p",{children:"Likely due to your internet connection."}),(0,r.jsx)("span",{className:"text-sm",children:" Click to Dismiss"})]})]})}):"",(0,r.jsxs)("div",{className:"flex hero sm:p-3 xl:p-5        justify-between xl:mt-0  ",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("p",{className:"cursor-pointer",onClick:()=>{T("recommended",0)},children:"Recommended"}),"recommended"===b?(0,r.jsx)("div",{className:" rounded-md   h-1 bg-blue-500"}):""]}),(0,r.jsxs)("div",{className:"flex flex-col text-sm",children:[(0,r.jsx)("p",{className:"cursor-pointer",onClick:()=>{T("following",0)},children:"Following"}),"following"===b?(0,r.jsx)("div",{className:" rounded-md   h-1 bg-blue-500"}):""]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("p",{className:"cursor-pointer",onClick:()=>{T("trending",0)},children:"Trending"}),"trending"===b?(0,r.jsx)("div",{className:" rounded-md  h-1 bg-blue-500"}):""]})]})]}),(0,r.jsx)(d.Z,{className:"   xl:mt-0 z-[-1] mt-3   flex flex-col  w-full 0 xl:p-0     ",dataLength:c.length,hasMore:!0,next:U,loader:"",children:c.length>0?c.map((t,s)=>(console.log(t),(0,r.jsx)("div",{className:"     sm:p-3  \n                         ".concat("dark"==theme?"xl:border xl:border-[#121212]":"xl:border xl:border-[#ecececd8]","  \n                        "),id:t.id,children:(0,r.jsx)(j,{isLast:s===c.length-1,cacheKey:"user-home-".concat(b,"-posts-").concat(p,"-").concat(x.authStore.model().id),...t,expand:t.expand,post:t,swapPage:e.swapPage,setParams:e.setParams,page:e.currentPage,currentPage:p})},t.id))):(0,r.jsx)(r.Fragment,{children:f?(0,r.jsx)("div",{className:"mx-auto flex justify-center",children:(0,r.jsx)("span",{className:"loading loading-spinner-large loading-spinner mt-5 text-blue-600"})}):f?"":(0,r.jsx)(r.Fragment,{children:"following"===b?(0,r.jsxs)("div",{className:"flex flex-col mt-6  justify-center",children:[(0,r.jsx)("p",{className:"text-center text-xl font-bold",children:"You're not following anyone."}),(0,r.jsx)("p",{className:"text-center text-sm",children:"Follow people to see their posts here."})]}):"recommended"===b?(0,r.jsx)("div",{className:"flex flex-col  justify-center",children:(0,r.jsxs)("p",{className:"text-center text-xl font-bold",children:["No recommended posts. :","("]})}):"trending"===b?(0,r.jsx)("div",{className:"flex flex-col  justify-center",children:(0,r.jsx)("p",{className:"text-center text-xl font-bold",children:"No trending posts."})}):(0,r.jsx)("div",{className:"flex flex-col  justify-center"})})})}),(0,r.jsx)("div",{className:"xl:hidden lg:hidden",children:(0,r.jsx)(i,{params:e.params,setParams:e.setParams,currentPage:e.currentPage,swapPage:e.swapPage})})]})})})}function B(e){let[t,s]=(0,n.useState)(!1),[l,a]=(0,n.useState)(""),[o,i]=(0,n.useState)("");(0,n.useEffect)(()=>{s(!0)},[]),x.authStore.isValid()&&e.swapPage("home"),window.matchMedia("(prefers-color-scheme: dark)").matches;let[c,d]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{c||setTimeout(()=>{d(!1)},1e3)},[c]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:" relative    p-5 w-screen  justify-center flex flex-col gap-5 mx-auto xl:w-[30vw] lg:w-[50vw] ",children:[(0,r.jsx)("div",{className:" mb-12 flex flex-col gap-5  w-full",children:(0,r.jsx)("p",{className:" mt-2 text-2xl w-full ",children:"Sign in to Postr"})}),(0,r.jsx)("label",{htmlFor:"email",children:"Email"}),(0,r.jsx)("div",{className:"relative w-full",children:(0,r.jsx)("input",{name:"email",onChange:e=>{i(e.target.value)},type:"email",className:"input rounded input-bordered w-full"})}),(0,r.jsx)("label",{htmlFor:"password",children:"Password"}),(0,r.jsx)("input",{name:"password",type:"password",className:"input rounded input-bordered w-full",onChange:e=>{a(e.target.value)}}),(0,r.jsx)("button",{onClick:()=>{d(!0),x.authStore.login(o,l).then(t=>{e.swapPage("home")}).catch(e=>{console.log(e)})},className:"btn  text-white rounded hover:bg-rose-500  bg-rose-500 relative",children:"Login"}),(0,r.jsx)("a",{onClick:()=>{e.swapPage("forgotPassword")},className:"text-xs cursor-pointer text-rose-500",children:"Forgot password?"}),(0,r.jsx)("a",{onClick:()=>{e.swapPage("register")},className:"text-xs  cursor-pointer text-rose-500",children:"Create account"})]},e.key)})}function I(e){let t=(0,n.useRef)(!1),[s,l]=(0,n.useState)([]),[a,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1);async function h(){d(!0);let e=await x.read({collection:"users",cacheKey:"bookmarks-".concat(x.authStore.model().id),id:x.authStore.model().id,expand:["bookmarks","bookmarks.author","bookmarks.comments","bookmarks.comments.user"]});l(e.expand.bookmarks?e.expand.bookmarks:[]),setTimeout(()=>{d(!1)},1e3)}return t.current||(h(),t.current=!0),(0,n.useEffect)(()=>{o(!0)},[s]),(0,r.jsx)(r.Fragment,{children:a?(0,r.jsxs)("div",{className:"relative xl:flex  sm:p-2  lg:flex   xl:w-[80vw]   justify-center xl:mx-auto    ",children:[(0,r.jsx)(C,{params:e.params,setParams:e.setParams,currentPage:e.currentPage,swapPage:e.swapPage}),(0,r.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,r.jsx)("div",{className:"sticky bg-white z-[999] xl:mx-24 p-3 sm:p-2 top-0",children:(0,r.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col ",children:[(0,r.jsx)("p",{className:"font-bold",children:"Bookmarks"}),(0,r.jsxs)("p",{children:["@",x.authStore.model().username]})]}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM12.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM18.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"})})]})}),(0,r.jsxs)("div",{className:" xl:mx-24  sm:p-2   text-md    relative  xl:w-[35vw] md:w-[80vw]  xl:text-sm md:text-sm",children:[(0,r.jsx)("div",{className:"mb-32",children:c?(0,r.jsx)("div",{children:(0,r.jsx)(b,{})}):(0,r.jsx)("div",{children:s.length>0?s.map(t=>(0,n.createElement)(j,{...t,key:t.id,post:t,page:"bookmarks",params:e.params,setParams:e.setParams,currentPage:e.currentPage,swapPage:e.swapPage,deleteBookmark:async()=>{l(s.filter(e=>e.id!==t.id))}})):(0,r.jsxs)("div",{className:"  flex flex-col mt-6 xl:justify-center xl:mx-auto  xl:p-5 lg:p-5 lg:justify-center lg:mx-auto w-[22rem] xl:w-[30rem] drop-shadow-md not-sr-only    ",children:[(0,r.jsx)("span",{className:"  font-bold text-2xl mt-2 ",children:"Save posts to view them here"}),(0,r.jsx)("span",{className:"text-sm",children:"Dont let your favorite posts get away. Tap the bookamark icon on the bottom of any post to add it to this collection. So you can easily find it later."})]})})}),(0,r.jsx)("div",{className:"xl:hidden lg:hidden",children:(0,r.jsx)(i,{params:e.params,setParams:e.setParams,currentPage:e.currentPage,swapPage:e.swapPage})})]})]}),(0,r.jsx)(S,{params:e.params,setParams:e.setParams,currentPage:e.currentPage,swapPage:e.swapPage})]}):""})}function A(e){let[t,s]=(0,n.useState)(!1),[l,a]=(0,n.useState)([]),[o,c]=(0,n.useState)({status:!1,type:""}),[d,h]=(0,n.useState)(""),m=(0,n.useRef)(!1);return(0,n.useEffect)(()=>{s(!0),m.current||(m.current=!0,x.list({collection:"collections",expand:["posts","members"],filter:'owner="'.concat(x.authStore.model().id,'"')}).then(e=>{a(e.items)}))},[]),(0,r.jsx)(r.Fragment,{children:t?(0,r.jsxs)("div",{className:"relative xl:flex   lg:flex   xl:w-[80vw]   justify-center xl:mx-auto    ",children:[(0,r.jsx)(C,{...e}),(0,r.jsxs)("div",{className:" xl:mx-24     text-md      relative    xl:w-[35vw]   md:w-[50vw]    h-screen      xl:text-sm md:text-sm",children:[(0,r.jsxs)("div",{className:" flex justify-between mt-2 gap-5 hero ",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"xl:w-6 xl:h-6 w-5 h-5 cursor-pointer         ",children:(0,r.jsx)("path",{"fill-rule":"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z","clip-rule":"evenodd"})}),(0,r.jsxs)("div",{className:"dropdown rounded w-full",children:[(0,r.jsx)("div",{tabIndex:0,role:"button",className:"w-full m-1",children:(0,r.jsx)("input",{onChange:e=>{h(e.target.value),e.target.value.length>0?(c({status:!0,type:"collections"}),x.list({collection:"collections",filter:'name~"'.concat(e.target.value,'"'),limit:10,page:0,sort:"-created",expand:["owner","members"]}).then(e=>{c({status:!1,type:"collections"}),a(null==e?void 0:e.items)})):a([])},type:"text",placeholder:"Find inspiration",className:"border focus:outline-none border-[#eaeaea] rounded-full p-3 w-full "})}),(0,r.jsx)("ul",{tabIndex:0,className:"dropdown-content z-[1] menu p-5 shadow bg-base-100 rounded-box w-full h-[15vh] ",children:(0,r.jsxs)("div",{className:"flex flex-col gap-5 hero mx-auto font-bold text-md",children:[(0,r.jsx)("p",{children:"Search for collections"}),o.status&&"search"==o.type?(0,r.jsx)("span",{className:"loading loading-spinner text-blue-500"}):"",l.length>0?l.map(e=>(0,r.jsxs)("div",{children:[e.name,(0,r.jsx)("button",{className:"btn",children:"Import"})]})):""]})})]}),(0,r.jsxs)("div",{className:"flex gap-5",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z"})}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})})]})]}),(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)("p",{className:"text-lg mt-12 font-bold",children:"Your Collections"}),0==l.length&&0==d.length?(0,r.jsxs)("div",{className:"flex flex-col gap-5 hero mx-auto font-bold text-md",children:[(0,r.jsx)("p",{children:"You don't have any collections yet"}),(0,r.jsx)("p",{children:"When you create a collection, it will appear here."}),(0,r.jsx)("button",{onClick:()=>{e.swapPage("createCollection")},className:"btn btn-md bg-blue-500 text-white",children:"Create a collection"})]}):"",0==l.length&&d.length>0?(0,r.jsxs)("div",{className:"flex flex-col gap-5 hero mx-auto font-bold text-md",children:[(0,r.jsx)("p",{children:"No collections found"}),(0,r.jsx)("p",{children:"Try searching for something else."})]}):"",l.length>0?(0,r.jsx)("div",{className:"flex flex-col gap-5  mt-5 font-bold text-md",children:l.map(e=>(0,r.jsx)("div",{className:"flex gap-2 flex-col",children:(0,r.jsxs)("div",{className:"flex gap-2 hero",children:[(0,r.jsx)("div",{className:"bg-blue-500 p-2 rounded-md",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-7 h-7",children:(0,r.jsx)("path",{"fill-rule":"evenodd",d:"M6 4.75A.75.75 0 0 1 6.75 4h10.5a.75.75 0 0 1 0 1.5H6.75A.75.75 0 0 1 6 4.75ZM6 10a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H6.75A.75.75 0 0 1 6 10Zm0 5.25a.75.75 0 0 1 .75-.75h10.5a.75.75 0 0 1 0 1.5H6.75a.75.75 0 0 1-.75-.75ZM1.99 4.75a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v.01a1 1 0 0 1-1 1h-.01a1 1 0 0 1-1-1v-.01ZM1.99 15.25a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v.01a1 1 0 0 1-1 1h-.01a1 1 0 0 1-1-1v-.01ZM1.99 10a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v.01a1 1 0 0 1-1 1h-.01a1 1 0 0 1-1-1V10Z","clip-rule":"evenodd"})})}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("p",{children:[e.name," - Members: ",e.members.length]}),(0,r.jsx)("p",{children:"Test"})]})]})}))}):""]}),(0,r.jsx)("div",{className:"xl:hidden lg:hidden",children:(0,r.jsx)(i,{...e})})]}),(0,r.jsx)(S,{...e})]}):""})}function T(e){let[t,s]=(0,n.useState)(!1),[l,a]=(0,n.useState)(""),[o,i]=(0,n.useState)("");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"  w-full",children:(0,r.jsxs)("div",{className:" p-5 mb-12 flex flex-col gap-5  w-full   xl:w-[30vw] lg:w-[50vw] md:w-[50vw]   justify-center mx-auto   ",children:[(0,r.jsx)("p",{className:" mt-2 text-2xl w-full ",children:"Reset your password"}),(0,r.jsx)("p",{className:"text-sm",children:"Enter your email address and we will send you a link to reset your password"}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("label",{id:"emaillabel",htmlFor:"email",children:"Email"}),(0,r.jsx)("input",{type:"email",className:"input rounded input-bordered",placeholder:"Enter Your Email"})]}),(0,r.jsx)("button",{className:"btn bg-blue-500 rounded ",onClick:()=>{!function(){let e=document.querySelector('input[type="email"]').value;if(0===e.length){document.getElementById("emaillabel").innerHTML="Email cannot be empty",document.getElementById("emaillabel").style.color="red",setTimeout(()=>{document.getElementById("emaillabel").innerHTML="Email",document.getElementById("emaillabel").style.color="black"},2e3);return}if(!/\S+@\S+\.\S+/.test(e)){document.getElementById("emaillabel").innerHTML="Please input a valid email",document.getElementById("emaillabel").style.color="red",setTimeout(()=>{document.getElementById("emaillabel").innerHTML="Email",document.getElementById("emaillabel").style.color="black"},2e3);return}x.authStore.requestPasswordReset(e).then(()=>{s(!1),i("Password reset successfully");let e=setTimeout(()=>{i(""),clearTimeout(e)},2e3);document.getElementById("passwordResetModal").showModal()}).catch(e=>{s(!1),a("An error occurred. Please try again later");let t=setTimeout(()=>{a(""),clearTimeout(t)},2e3)})}()},children:"Request Password Reset"}),(0,r.jsx)("span",{onClick:()=>e.swapPage("login"),className:"text-blue-500 rounded cursor-pointer",children:"Back to login"})]})}),(0,r.jsx)("dialog",{id:"passwordResetModal",className:"modal rounded-md",children:(0,r.jsxs)("div",{className:"modal-box flex  rounded flex-col gap-5 \n             ".concat("dark"===theme?"bg-black  border-[#121212] border-2 border-b-none ":"bg-white  border   border-[#f6f4f4] bg-opacity-75 bg-white ","  \n              p-5"),children:[(0,r.jsx)("p",{children:"Reset Password"}),(0,r.jsx)("p",{children:"A link to reset your password has been sent to your email. Please check your email and follow the instructions to reset your password."}),(0,r.jsx)("button",{onClick:()=>{document.getElementById("passwordResetModal").close()},className:"btn bg-blue-500 rounded",children:"OK"})]})})]})}function U(e){let[t,s]=(0,n.useState)(""),[l,a]=(0,n.useState)(""),[o,i]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[h,m]=(0,n.useState)(""),[u,p]=(0,n.useState)(!1),[g,w]=(0,n.useState)(!1),f=new URLSearchParams(window.location.search);return f.get("token")||e.swapPage("forgotPassword"),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"    w-full   ",children:(0,r.jsxs)("div",{className:" p-5 mb-12 flex flex-col gap-5 justify-center mx-auto w-full   xl:w-[30vw] lg:w-[50vw] md:w-[50vw]   ",children:[(0,r.jsx)("p",{className:" mt-2 text-2xl w-full ",children:"Reset your password"}),(0,r.jsx)("p",{className:"text-sm",children:"Enter a new Strong password"}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("label",{id:"passwordlabel",htmlFor:"password",children:"Password"}),(0,r.jsx)("input",{maxLength:100,minLength:8,type:"password",onChange:e=>{s(e.target.value)},className:"input rounded input-bordered",placeholder:"Enter Your Password"}),(0,r.jsx)("label",{id:"confirmpasswordlabel",htmlFor:"confirmpassword",children:"Confirm Password"}),(0,r.jsx)("input",{type:"password",className:"input rounded input-bordered",onChange:e=>{a(e.target.value)},placeholder:"Confirm Your Password"}),(0,r.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,r.jsx)("p",{className:"text-red-500",children:c}),(0,r.jsx)("p",{className:"text-green-500",children:h})]})]}),(0,r.jsx)("button",{className:"btn rounded bg-blue-500",onClick:()=>{!function(){if(!1===function(){if(console.log(t.length),t.length<8){d("Password must be at least 8 characters and less than 50 characters"),p(!0);let e=setTimeout(()=>{d(""),p(!1),clearTimeout(e)},2e3);return!1}if(t!==l){d("Passwords do not match");let e=setTimeout(()=>{d(""),clearTimeout(e)},2500);return!1}let e=t.split(""),s=!1,a=!1,o=!1;for(let t=0;t<e.length;t++)e[t].match(/[a-zA-Z]/)&&(s=!0),e[t].match(/[0-9]/)&&(a=!0),e[t].match(/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/)&&(o=!0);if(!s){d("Password must contain at least one letter"),p(!0);let e=setTimeout(()=>{d(""),p(!1),clearTimeout(e)},2e3);return!1}if(!a){d("Password must contain at least one number"),p(!0);let e=setTimeout(()=>{d(""),p(!1),clearTimeout(e)},2e3);return!1}if(!o){d("Password must contain at least one special character"),p(!0);let e=setTimeout(()=>{d(""),p(!1),clearTimeout(e)},2e3);return!1}return!0}())return;w(!0);let e=f.get("token");console.log({token:e,password:t}),document.getElementById("passwordResetModal").showModal(),w(!1),m("Password reset successfully"),x.authStore.resetPassword(e,t).then(e=>{w(!1),m("Password reset successfully");let t=setTimeout(()=>{m(""),clearTimeout(t)},2e3);document.getElementById("passwordResetModal").showModal()}).catch(e=>{console.log(e),d(e.message),p(!0)})}()},children:"Reset Password"})]})}),(0,r.jsx)("dialog",{id:"passwordResetModal",className:"modal rounded-md",children:(0,r.jsxs)("div",{className:"modal-box flex  rounded flex-col gap-5 \n             ".concat("dark"===theme?"bg-black  border-[#121212] border-2 border-b-none ":"bg-white  border   border-[#f6f4f4] bg-opacity-75 bg-white ","  \n              p-5"),children:[(0,r.jsx)("p",{children:"Succesfully Reset Password"}),(0,r.jsx)("p",{children:"You have successfully reset your password. You can now login with your new password."}),(0,r.jsx)("button",{onClick:()=>{document.getElementById("passwordResetModal").close(),window.history.pushState({},document.title,"/"),e.swapPage("login")},className:"btn bg-blue-500 rounded",children:"Login"})]})})]})}function z(e){return(0,r.jsxs)(O,{...e,children:[(0,r.jsxs)("div",{className:" xl:w-[35vw]   md:w-[50vw]   p-5 mt-5  mx-auto flex flex-col gap-5",children:[(0,r.jsxs)("div",{className:"flex hero gap-5",children:[(0,r.jsx)("div",{className:"hover:border-slate-200 hover:bg-white btn-ghost btn btn-circle btn-sm bg-white",children:(0,r.jsx)("svg",{onClick:()=>{let t=e.lastPage;e.swapPage(t)},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"xl:w-6 xl:h-6 w-5 h-5 cursor-pointer         ",children:(0,r.jsx)("path",{"fill-rule":"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z","clip-rule":"evenodd"})})}),(0,r.jsx)("h1",{className:"text-xl flex hero gap-2",children:" Settings"})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex flex-col ",children:[(0,r.jsx)("h1",{children:"Account Management"}),(0,r.jsx)("p",{className:"opacity-50 text-sm",children:"Manage your account, change password details and more"})]}),(0,r.jsxs)("div",{className:"mt-2 gap-2 flex",children:[(0,r.jsx)("button",{className:"btn-ghost btn-sm rounded-full border-slate-200",onClick:()=>{var e;null===(e=document.getElementById("change_password"))||void 0===e||e.showModal()},children:"Change Password"}),(0,r.jsx)("button",{className:"btn-ghost btn-sm rounded-full border-slate-200",children:"Request Account Data"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)("h1",{children:"Manage Subscriptions"})}),x.authStore.model().postr_plus?(0,r.jsxs)("div",{className:"p-5 bg-base-200 rounded-xl",children:[(0,r.jsx)("p",{className:"from-blue-500 to-purple-500 bg-gradient-to-r  text-transparent bg-clip-text font-bold",children:"Postr++"}),(0,r.jsx)("p",{children:"Status: Subscribed"}),(0,r.jsx)("p",{children:"Next Payment: 6/25/2024"})]}):(0,r.jsx)("div",{className:"p-5 bg-base-200",children:(0,r.jsx)("p",{children:"Status: Not Subscribed"})})]})]}),(0,r.jsx)(c,{id:"change_password",className:"xl:h-[400px] md:h-[400px] h-[390px] xl:w-[500px] md:w-[500px] rounded-md",children:(0,r.jsx)("form",{method:"dialog",children:(0,r.jsxs)("div",{className:"w-full flex flex-col gap-5 p-5",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("h1",{children:"Change Password"}),(0,r.jsx)("button",{type:"submit",className:"text-blue-500",children:"Cancel"})]}),(0,r.jsx)("input",{type:"password",placeholder:"Current Password",className:"input input-bordered"}),(0,r.jsx)("label",{children:"New Password"}),(0,r.jsx)("input",{type:"password",placeholder:"New Password",className:"input input-bordered"}),(0,r.jsx)("input",{type:"password",placeholder:"Confirm new Password",className:"input input-bordered"}),(0,r.jsx)("button",{className:"btn btn-ghost border-slate-200 ",children:"Confirm Password Change"})]})})})]})}function R(e){let[t,s]=(0,n.useState)(null);return(0,n.useEffect)(()=>{e.params.hasOwnProperty("post")?s(e.params.post):x.read({collection:e.type||e.params.type,id:e.id||e.params.id,cacheKey:"".concat(e.type||e.params.type,"-").concat(e.id||e.params.id,"-status"),expand:["author","comments","comments.user","likes","followers","following"]}).then(e=>{s(e)})},[]),(0,n.useEffect)(()=>{if(t){window.engamentReferer=t.id;let l=t.views;l.includes(x.authStore.model().id)||(l.push(x.authStore.model().id),x.update({collection:"posts",id:e.id||e.params.id,cacheKey:"".concat(e.type||e.params.type,"-").concat(e.id||e.params.id,"-status"),invalidateCache:["user-home-feed-".concat(x.authStore.model().id),"user-feed-posts-1-".concat(t.author)],record:{views:l}}).then(e=>{s({...t,views:l})})),document.title="".concat(t.expand.author.username.charAt(0).toUpperCase()+t.expand.author.username.slice(1),' on Postr "').concat(t.content.slice(0,20),'..." - Postr')}},[t]),console.log(t),(0,r.jsxs)("div",{className:" relative xl:flex  2xl:w-[80vw]  lg:flex w-full  justify-center xl:mx-auto",children:[(0,r.jsx)(C,{...e}),(0,r.jsxs)("div",{className:"  xl:w-[35vw]\n         md:w-[50vw]  xl:mx-24 \n         ".concat("dark"==theme?"\n            ".concat(t&&t.comments.length>0&&"border-[#121212] border-2","\n            "):t&&t.comments.length>0&&"border-[#f8f7f7] border-2","\n         "),children:[(0,r.jsxs)("div",{className:"flex hero gap-5  p-2 xl:mx-5 lg:mx-5 md:mx-5 \n        ".concat("dark"==theme?"bg-black text-white":"bg-white text-black","    \n        w-full"),children:[(0,r.jsx)("div",{className:"\n        ".concat("dark"==theme?"bg-black text-white fill-white hover:border-slate-200":"hover:border-slate-200 hover:bg-white","\n        btn-ghost btn btn-circle btn-sm    "),children:(0,r.jsx)("span",{"data-tip":"Go back",className:"tooltip tooltip-bottom",children:(0,r.jsx)("svg",{onClick:()=>{let t=e.lastPage;e.swapPage(t)},viewBox:"0 0 24 24","aria-hidden":"true",className:"w-6 h-6 cursor-pointer  xl:w-6 xl:h-6 ",children:(0,r.jsx)("g",{children:(0,r.jsx)("path",{d:"M7.414 13l5.043 5.04-1.414 1.42L3.586 12l7.457-7.46 1.414 1.42L7.414 11H21v2H7.414z"})})})})}),(0,r.jsx)("h1",{children:e.type.charAt(0).toUpperCase()+e.type.slice(1)})]}),(0,r.jsxs)("div",{className:" mt-5",children:[t?(0,r.jsx)(j,{...t,showFullDate:!0,showFullContent:!0,actions:{clicks_user_profile:()=>{window.referedFrom="status_"+t.id}},cacheKey:"".concat(e.type||e.params.type,"-").concat(e.id||e.params.id,"-status"),...e}):(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"flex flex-col gap-5 w-full",children:(0,r.jsx)(b,{})})}),t?(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"flex flex-col  w-full",children:t.expand.comments&&t.expand.comments.length>0?t.expand.comments.map(s=>(console.log(s),(0,r.jsx)("div",{style:{borderTop:"dark"==theme?"1px solid #121212":"1px solid #f8f7f7"},className:"\n                                         \n                                        ",children:(0,r.jsx)(Comment,{...s,currentPage:e.currentPage,post:t,user:s.expand.user,statusPage:!0})},s.id))):(0,r.jsxs)("div",{className:"mx-auto justify-center w-full flex mt-2 hero flex-col",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-center",children:"No Comments \uD83D\uDE22"}),(0,r.jsx)("p",{className:"text-gray-500 text-sm  text-center prose w-[300px] break-normal mt-6 ",children:"Be the first to comment on this post."})]})})}):""]})]}),(0,r.jsx)(S,{...e}),(0,r.jsx)("div",{className:"xl:hidden lg:hidden",children:(0,r.jsx)(i,{...e})})]})}var V=s(4033);function H(e){var t,s,l,a;let o=(0,V.useSearchParams)();window.matchMedia("(prefers-color-scheme: dark)").matches;let[i,c]=(0,n.useState)({email:o.get("email")?null===(t=o.get("email"))||void 0===t?void 0:t.toString():null,name:o.get("name")?null===(s=o.get("name"))||void 0===s?void 0:s.toString():null}),d=(0,n.useRef)(),h=(0,n.useRef)(),[m,u]=(0,n.useState)(null),[p,g]=(0,n.useState)(null),[w,f]=(0,n.useState)(!1),[v,j]=(0,n.useState)(o.get("email")?null===(l=o.get("email"))||void 0===l?void 0:l.toString():null),[b,k]=(0,n.useState)(o.get("name")?null===(a=o.get("name"))||void 0===a?void 0:a.toString():null),N=(0,n.useRef)();async function y(){f(!0),u(!1),g(!1),N.current.disabled=!0;try{if(!function(){if("name"in i){if(!("email"in i)){h.current.innerHTML="Please input a valid email",h.current.style.color="red";let e=setTimeout(()=>{h.current.style.color="black",h.current.innerHTML="Email",clearTimeout(e)},2e3);return!1}}else{d.current.innerHTML="Please input a name",d.current.style.color="red";let e=setTimeout(()=>{d.current.style.color="black",d.current.innerHTML="Name",clearTimeout(e)},2e3);return!1}if(!/\S+@\S+\.\S+/.test(v)){h.current.innerHTML="Please input a valid email",h.current.style.color="red";let e=setTimeout(()=>{h.current.style.color="black",h.current.innerHTML="Email",clearTimeout(e)},2e3);return!1}return!0}()){f(!1),g(!1),N.current.disabled=!1;return}let t=await x.checkName(b),s=await x.checkName(v);if(console.log(v),t){d.current.innerHTML="Name already exists",d.current.style.color="red",u("error"),g(!1),f(!1),N.current.disabled=!1;return}if(s){h.current.innerHTML="Email already exists",h.current.style.color="red",g("error"),u(!1),f(!1),N.current.disabled=!1;return}u(!0),g(!0),f(!1),e.setParams({username:b,email:v}),e.swapPage("signup/finish")}catch(e){u(!1),g(!1),f(!1)}}return(0,r.jsxs)("div",{className:" relative    p-5 w-screen  justify-center flex flex-col gap-5 mx-auto   xl:w-[30vw] lg:w-[50vw]   ",children:[(0,r.jsxs)("div",{className:" mb-12 flex flex-col gap-5  w-full",children:[(0,r.jsx)("div",{className:"flex justify-between gap-2 hero",children:(0,r.jsx)("p",{className:"text-blue-500 cursor-pointer",onClick:()=>e.swapPage("login"),children:" Sign in"})}),(0,r.jsx)("p",{className:" mt-2 text-2xl w-full ",children:"Create your account"})]}),(0,r.jsx)("label",{htmlFor:"username",ref:d,children:"Name"}),(0,r.jsxs)("div",{className:"relative w-full",children:[(0,r.jsx)("input",{name:"username",value:b,onChange:e=>{c({...i,name:e.target.value}),k(e.target.value)},type:"text",className:"input input-bordered w-full"}),w&&!m?(0,r.jsx)("span",{className:"loading loading-spinner absolute end-5 top-1/2 transform -translate-y-1/2 right-3"}):"",!0===m?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-green-500 absolute end-5 top-1/2 transform -translate-y-1/2 right-3",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):"error"===m?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6    text-red-500 absolute end-5 top-1/2 transform -translate-y-1/2 right-3   ",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):""]}),(0,r.jsx)("label",{htmlFor:"email",ref:h,children:"Email"}),(0,r.jsxs)("div",{className:"relative w-full",children:[(0,r.jsx)("input",{name:"username",value:v,onChange:e=>{c({...i,email:e.target.value}),j(e.target.value)},type:"text",className:"input input-bordered w-full"}),w&&!m?(0,r.jsx)("span",{className:"loading loading-spinner absolute end-5 top-1/2 transform -translate-y-1/2 right-3"}):"",!0===p?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-green-500 absolute end-5 top-1/2 transform -translate-y-1/2 right-3",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):"error"===p?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6    text-red-500 absolute end-5 top-1/2 transform -translate-y-1/2 right-3   ",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):""]}),(0,r.jsxs)("button",{ref:N,onClick:()=>{y()},className:"btn  text-white hover:bg-rose-500  bg-rose-500 relative",children:["Next",(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 15l3-3m0 0l-3-3m3 3h-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]})]})}function F(e){let[t,s]=(0,n.useState)(""),l=(0,n.useRef)();async function a(){if(t.length<8||t.length>50){l.current.innerHTML="Password must be at least 8 characters and less than 50 characters",l.current.style.color="red";let e=setTimeout(()=>{l.current.innerHTML="Create a password",l.current.style.color="black",clearTimeout(e)},2e3);return}console.log(await x.authStore.create({username:e.params.username,email:e.params.email,password:t,followers:[],following:[],bookmarks:[]})),document.getElementById("signupModal").showModal()}return(0,r.jsxs)("div",{className:"relative    p-5 w-screen  justify-center flex flex-col gap-3 mx-auto   xl:w-[30vw] lg:w-[50vw]",children:[(0,r.jsxs)("div",{className:" mb-12 flex flex-col gap-5  w-full",children:[(0,r.jsx)("div",{className:"flex justify-between gap-2 hero",children:(0,r.jsx)("p",{className:"text-blue-500 cursor-pointer",onClick:()=>e.swapPage("login"),children:"Login"})}),(0,r.jsx)("p",{className:" mt-2 text-2xl w-full ",children:"Create your account"})]}),(0,r.jsx)("label",{htmlFor:"username",className:"text-sm",children:"Name"}),(0,r.jsxs)("div",{className:"relative w-full",children:[(0,r.jsx)("input",{name:"username",value:e.params.username,disabled:!0,type:"text",className:"input input-bordered w-full placeholder:text-blue-500"}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-green-500 absolute end-5 top-1/2 transform -translate-y-1/2 right-3",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,r.jsx)("label",{htmlFor:"email",className:"text-sm",children:"Email"}),(0,r.jsxs)("div",{className:"relative w-full",children:[(0,r.jsx)("input",{name:"email",disabled:!0,value:e.params.email,type:"text",className:"input input-bordered placeholder:text-blue-500 w-full"}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 text-green-500 absolute end-5 top-1/2 transform -translate-y-1/2 right-3",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",ref:l,className:"text-sm",children:"Create a password"}),(0,r.jsx)("div",{className:"relative w-full",children:(0,r.jsx)("input",{name:"password",placeholder:t,onChange:e=>{s(e.target.value)},type:"password",className:"input input-bordered placeholder:text-blue-500 w-full"})})]}),(0,r.jsxs)("p",{children:["By clicking signup you agree to follow our"," ",(0,r.jsx)("a",{className:"text-blue-500",href:"/information/terms.pdf",target:"_blank",children:"Terms of Service"})," ","and"," ",(0,r.jsx)("a",{className:"text-blue-500",href:"/information/privacy.pdf",target:"_blank",children:"Privacy Policy"})]}),(0,r.jsx)("button",{onClick:()=>{a()},className:"btn  text-white hover:bg-blue-500 bg-blue-500    relative",children:"Signup"}),(0,r.jsx)("dialog",{id:"signupModal",className:"modal rounded-md",children:(0,r.jsxs)("div",{className:"modal-box flex  rounded flex-col gap-5 \n             ".concat("dark"===theme?"bg-black  border-[#121212] border-2 border-b-none ":"bg-white  border   border-[#f6f4f4] bg-opacity-75 bg-white ","  \n              p-5"),children:[(0,r.jsx)("p",{className:"text-green-500",children:"Succesfully Signed Up"}),(0,r.jsx)("p",{children:"You have successfully signed up. Please check your email for a verification link to verify your account."}),(0,r.jsx)("button",{onClick:()=>{document.getElementById("passwordResetModal").close(),e.swapPage("login")},className:"btn bg-blue-500 rounded",children:"Login"})]})})]})}function O(){let e=new URLSearchParams(window.location.search),[t,s]=(0,n.useState)(e.has("view")?"view":e.has("forgot_password")?"resetPassword":"home");window.location.href.includes("forgot_password")||"resetPassword"!=t||s("home");let[l,a]=(0,n.useState)({}),[o,i]=(0,n.useState)("home"),[c,d]=(0,n.useState)(!1),[h,m]=(0,n.useState)(!1),[u,p]=(0,n.useState)(e.has("view")),[g,w]=(0,n.useState)(!1),f=(0,n.useRef)(!1),v=window.matchMedia("(prefers-color-scheme: dark)").matches;switch(window.theme=v?"dark":"light",window.theme=v?"dark":"light",window.addEventListener("online",e=>{e.detail.online.get("latency")>2e3?d(!0):d(!1)}),(0,n.useEffect)(()=>{if(v&&document.documentElement.setAttribute("data-theme","black"),!f.current){f.current=!0,x.events.on("offline",()=>{d(!0)}),x.authStore.onChange(()=>{console.log(x.authStore.isValid()),!x.authStore.isValid()&&x.authStore.model()&&"login"!==t&&!u?x.authStore.refreshToken():x.authStore.isValid()&&(console.log("Auth store is valid"),s("home"))});let e=()=>{x.authStore.refreshToken(),setTimeout(()=>{e()},9e5)};e()}return()=>{f.current=!1}},[]),console.log(t),x.authStore.isValid()||"login"===t||"register"===t||"signup/finish"===t||"forgotPassword"===t||"resetPassword"===t||s("login"),(0,n.useEffect)(()=>{t!==o&&"user"!==t&&"settings"!==t&&"view"!==t&&i(t)},[t,o]),!0){case"home"==t:return(0,r.jsx)(D,{swapPage:s,setParams:a,params:l,theme:v?"dark":"light",setLastPage:i,currentPage:t,lastPage:o},crypto.randomUUID());case x.authStore.isValid()&&"user"==t:return(0,r.jsx)(P,{currentPage:t,swapPage:s,setParams:a,params:l,setLastPage:i,lastPage:o,page:t},crypto.randomUUID());case x.authStore.isValid()&&"bookmarks"==t:return(0,r.jsx)(I,{swapPage:s,setParams:a,params:l,setLastPage:i,lastPage:o,page:t},crypto.randomUUID());case x.authStore.isValid()&&"post"==t:return(0,r.jsx)(r.Fragment,{});case x.authStore.isValid()&&"collections"==t:return(0,r.jsx)(A,{swapPage:s,setParams:a,params:l,setLastPage:i,lastPage:o,currentPage:t},crypto.randomUUID());case x.authStore.isValid()&&"settings"==t:return(0,r.jsx)(z,{swapPage:s,setParams:a,params:l,setLastPage:i,lastPage:o,currentPage:t},crypto.randomUUID());case x.authStore.isValid()&&"view"==t||x.authStore.isValid()&&u:return(0,r.jsx)(R,{key:crypto.randomUUID(),swapPage:s,setParams:a,params:l,setLastPage:i,lastPage:o,currentPage:t,id:e.get("id")||"",type:e.get("type")||""});case"register"==t:return(0,r.jsx)(H,{key:crypto.randomUUID(),swapPage:s,setParams:a,params:l,currentPage:t,setLastPage:i,lastPage:o});case"signup/finish"==t:return(0,r.jsx)(F,{key:crypto.randomUUID(),swapPage:s,setParams:a,params:l,currentPage:t,setLastPage:i,lastPage:o});case"forgotPassword"==t:return(0,r.jsx)(T,{swapPage:s,setParams:a,params:l,setLastPage:i,lastPage:o,currentPage:t},crypto.randomUUID());case"resetPassword"==t:return(0,r.jsx)(U,{swapPage:s,setParams:a,params:l,setLastPage:i,lastPage:o,currentPage:t},crypto.randomUUID());default:return(0,r.jsx)(B,{swapPage:s,setParams:a,params:l,currentPage:t,setLastPage:i,lastPage:o},crypto.randomUUID())}}}},function(e){e.O(0,[746,971,472,744],function(){return e(e.s=9971)}),_N_E=e.O()}]);