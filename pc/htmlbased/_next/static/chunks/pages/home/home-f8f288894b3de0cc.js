(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53],{5669:function(e,o,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/home/home",function(){return t(9141)}])},9141:function(e,o,t){"use strict";t.r(o),t.d(o,{default:function(){return x}});var s=t(5893),l=t(7494);function a(e){return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:e.fill||"none",viewBox:"0 0 24 24",strokeWidth:e.width||1.5,stroke:e.stroke||"currentColor",className:e.className,onClick:e.onClick,children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}var r=t(7294),c=t(738),n=t(2506),d=t(2545),i=t(8565),h=t(230),u=t(3188);function m(e){let[o,t]=(0,r.useState)(!1),[l,a]=(0,r.useState)(!1);return(0,s.jsxs)("div",{className:"relative xl:flex   lg:flex   2xl:w-[80vw]   justify-center xl:mx-auto    ",children:[(0,s.jsx)(h.k,{...e}),e.children,o&&!l?(0,s.jsx)("div",{onClick:()=>{a(!0)},className:"toast toast-end sm:toast-center  text-sm sm:hidden xsm:hidden  sm:top-0 ",children:(0,s.jsxs)("div",{className:"alert bg-[#f82d2df5] text-white  hero flex flex-row gap-2   font-bold shadow rounded-box",children:[(0,s.jsx)("span",{children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})})}),(0,s.jsxs)("p",{children:["Poor connection detected.",(0,s.jsx)("p",{children:"Likely due to your internet connection."}),(0,s.jsx)("span",{className:"text-sm",children:" Click to Dismiss"})]})]})}):"",(0,s.jsx)(h.h,{params:e.params,setParams:e.setParams,currentPage:e.currentPage,swapPage:e.swapPage}),(0,s.jsx)(u.Z,{...e}),(0,s.jsx)("div",{className:"xl:hidden lg:hidden",children:(0,s.jsx)(i.L,{...e})})]},e.key)}function x(e){var o,t;let[h,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{u(!0),window.history.pushState({},"","/")},[]);let x=(0,r.useRef)(!1),[p,f]=(0,r.useState)([]),[g,w]=(0,r.useState)(0),[v,j]=(0,r.useState)(1),[S,b]=(0,r.useState)(!1),[N,k]=(0,r.useState)((null===(o=window)||void 0===o?void 0:o.page)||"recommended"),[P,y]=(0,r.useState)(!0),[C,L]=(0,r.useState)(window.scrollY),[_,E]=(0,r.useState)(!1),[M,Z]=(0,r.useState)(!1);window.addEventListener("online",e=>{e.detail.online.get("latency")>2e3?E(!0):E(!1)});let[z,T]=(0,r.useState)(!0);function B(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],window.page=e,k(e),b(!0),d.h.cacheStore.has("user-home-".concat(e,"-posts-1-").concat(d.h.authStore.model().id))){let o=JSON.parse(d.h.cacheStore.get("user-home-".concat(e,"-posts-1-").concat(d.h.authStore.model().id))).value;f(o.items),w(o.totalPages),T(!0),b(!1);return}let o="following"===e?'author.followers ?~"'.concat(d.h.authStore.model().id,'"'):"recommended"===e?' author !="'.concat(d.h.authStore.model().id,'" && author.followers !~ "').concat(d.h.authStore.model().id,'"'):"trending"===e?'likes:length > 5 && author.id !="'.concat(d.h.authStore.model().id,'" && author.followers !~"').concat(d.h.authStore.model().id,'"'):"";f([]),console.log(!0),console.log(o),d.h.list({collection:"posts",limit:10,filter:o,refresh:!0,refreshEvery:1200,cacheKey:"user-home-".concat(e,"-posts-1-").concat(d.h.authStore.model().id),expand:["author","comments.user","user","post","post.author","author.followers","author.following","author.following.followers","author.following.following","repost","repost.author","repost.author.followers","repost.author.following","repost.likes","repost.comments.user","likes"],page:0,sort:"-created"}).then(o=>{f(o.items),w(o.totalPages),d.h.cacheStore.has("user-home-".concat(e,"-posts-1-").concat(d.h.authStore.model().id))||d.h.cacheStore.set("user-home-".concat(e,"-posts-1-").concat(d.h.authStore.model().id),{items:o.items,totalPages:o.totalPages},1200),T(!0),b(!1)})}async function F(){let{ratelimited:e,limit:o,duration:t,used:s}=await d.h.authStore.isRatelimited("list");switch(!0){case e:break;case v>=g:T(!1);break;case d.h.cacheStore.has("user-home-".concat(N,"-posts-").concat(v+1,"-").concat(d.h.authStore.model().id)):f([...p,...d.h.cacheStore.get("user-home-".concat(N,"-posts-").concat(v+1,"-").concat(d.h.authStore.model().id))]),j(e=>e+1);break;default:let l="following"===N?'author.followers ?~"'.concat(d.h.authStore.model().id,'"'):"recommended"===N?' && author.id !="'.concat(d.h.authStore.model().id,'" && author.followers !~"').concat(d.h.authStore.model().id,'"'):"trending"===N?'likes:length > 5 && author.id !="'.concat(d.h.authStore.model().id,'" && author.followers !~"').concat(d.h.authStore.model().id,'"'):"";await d.h.list({collection:"posts",limit:10,page:v+1,cacheKey:"user-home-".concat(N,"-posts-").concat(v+1,"-").concat(d.h.authStore.model().id),filter:l,cacheTime:1200,expand:["author","comments.user","user","post","post.author","author.followers","author.following","author.following.followers","author.following.following","repost","repost.author","repost.author.followers","repost.author.following","repost.likes","repost.comments","repost.comments.user","likes","likes"],sort:"-created"}).then(e=>{d.h.cacheStore.set("user-home-".concat(N,"-posts-").concat(v+1,"-").concat(d.h.authStore.model().id),e.items,1200),f([...p,...e.items]),w(e.totalPages),j(e=>e+1)}).catch(e=>{console.log(e)})}}return(0,r.useLayoutEffect)(()=>{var e,o,t,s,l,a;if(b(!0),d.h.cacheStore.has("user-home-".concat(N,"-posts-1-").concat(null===(e=d.h.authStore.model())||void 0===e?void 0:e.id))){let e=JSON.parse(d.h.cacheStore.get("user-home-".concat(N,"-posts-1-").concat(null===(o=d.h.authStore.model())||void 0===o?void 0:o.id))).value;f(e.items),w(e.totalPages),T(!0),setTimeout(()=>{b(!1)},1e3)}else{window.onscroll=()=>{L(window.scrollY)},j(1);let e="following"===N?' author.followers ~"'.concat(null===(t=d.h.authStore.model())||void 0===t?void 0:t.id,'"'):"recommended"===N?' author !="'.concat(null===(s=d.h.authStore.model())||void 0===s?void 0:s.id,'" && author.followers !~ "').concat(null===(l=d.h.authStore.model())||void 0===l?void 0:l.id,'"'):"trending"===N?'likes:length > 5 && author.id !="'.concat(d.h.authStore.model().id,'" && author.followers !~"').concat(d.h.authStore.model().id,'"'):"";d.h.list({collection:"posts",limit:10,page:1,cacheKey:"user-home-".concat(N,"-posts-1-").concat(null===(a=d.h.authStore.model())||void 0===a?void 0:a.id),cacheTime:1200,filter:e,expand:["author","comments.user","user","post","post.author","author.followers","author.following","author.following.followers","author.following.following","repost","repost.author","repost.author.followers","repost.author.following","repost.likes","repost.comments","repost.comments.user","comments","likes"],sort:"-created"}).then(e=>{var o;d.h.cacheStore.set("user-home-".concat(N,"-posts-1-").concat(null===(o=d.h.authStore.model())||void 0===o?void 0:o.id),{totalPages:e.totalPages,items:e.items},1200),w(e.totalPages),f(e.items),b(!1)})}return document.title="Postr - ".concat(N),!d.h.authStore.isValid()||d.h.isSubscribed("posts")||d.h.isSubscribed("users")||(d.h.subscribe({collection:"posts",event:"*"},e=>{if("update"==e.event&&e.record.author.id!==d.h.authStore.model().id)for(var o of d.h.cacheStore.keys()){let s=JSON.parse(d.h.cacheStore.get(o)).value.items;if(s){for(var t of s)t.id===e.record.id&&(t=e.record,s=s.map(e=>e.id===t.id?t:e));d.h.cacheStore.set(o,{totalPages:d.h.cacheStore.get(o).totalPages,items:s},1200)}}}),d.h.subscribe({collection:"users",event:"*"},e=>{if("update"==e.event&&e.record.id===d.h.authStore.model().id)d.h.authStore.model(e.record);else for(var o of d.h.cacheStore.keys())if(o.includes("user-profile")&&o.includes(e.record.id)){console.log(o);let t=JSON.parse(d.h.cacheStore.get(o)).value;t=e.record,d.h.cacheStore.set(o,t,1200)}else o.includes("user-home")&&o.includes("following")&&e.record.followers.includes(d.h.authStore.model().id),d.h.cacheStore.delete(o)}),console.log("Subscribed to posts")),()=>{x.current=!0}},[]),(0,r.useEffect)(()=>{document.title="Postr - ".concat(N.charAt(0).toUpperCase()+N.slice(1))},[N]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(m,{...e,children:(0,s.jsxs)("div",{className:" xl:mx-24     text-md    relative  xl:w-[35vw] md:w-[50vw]    xl:text-sm md:text-sm",children:[C>250&&p.length>10?(0,s.jsxs)("div",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"fixed top-4 p-3 w-fit h-10 xl:top-[17rem]  z-[999] cursor-pointer  translate-x-0 inset-x-0  mx-auto flex hero gap-2 text-white    rounded-full bg-[#43b1f1]",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-7 h-7",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 15a.75.75 0 01-.75-.75V7.612L7.29 9.77a.75.75 0 01-1.08-1.04l3.25-3.5a.75.75 0 011.08 0l3.25 3.5a.75.75 0 11-1.08 1.04l-1.96-2.158v6.638A.75.75 0 0110 15z",clipRule:"evenodd"})}),(0,s.jsx)("div",{className:"border-none    -space-x-2  flex",children:Array.from([,,,].keys()).map(e=>{let o=p[e];return(0,s.jsx)("div",{className:"flex hero gap-2",children:(0,s.jsx)("div",{className:"avatar border-none",children:(0,s.jsx)("div",{className:"w-8",children:(0,s.jsx)("img",{src:d.h.cdn.url({id:null==o?void 0:o.expand.author.id,collection:"users",file:null==o?void 0:o.expand.author.avatar}),alt:"avatar",className:"rounded-full object-contain w-full h-full"})})})})})})," ",(0,s.jsx)("p",{className:"text-sm",children:"posted"})]}):"",(0,s.jsxs)("div",{style:{borderBottom:"none"},className:" xl:sticky xl:top-0       w-[100%]  xl:z-[999] flex flex-col \n            ".concat("dark"===theme?"bg-black  border-[#121212] border-2 border-b-none ":"bg-white  border   border-[#f6f4f4] bg-opacity-75 bg-white ","  \n            "),children:[(0,s.jsx)("div",{className:"flex xl:p-5 w-full sm:p-3  justify-between ",children:(0,s.jsx)("div",{className:"flex gap-2 hero",children:(0,s.jsx)("div",{className:"flex flex-col   w-full",children:(0,s.jsxs)("div",{className:"flex  justify-between gap-2 w-full",children:[(0,s.jsxs)("div",{className:"flex flex-row  gap-2  ",children:[(0,s.jsxs)("div",{className:"dropdown     ",children:[(0,s.jsx)("label",{tabIndex:0,children:(0,s.jsx)(s.Fragment,{children:(null===(t=d.h.authStore.model())||void 0===t?void 0:t.avatar)?(0,s.jsx)("img",{src:d.h.authStore.img(),alt:d.h.authStore.model().username,className:"rounded object-cover w-12 h-12 cursor-pointer"}):(0,s.jsx)("div",{className:"avatar placeholder",children:(0,s.jsx)("div",{className:"bg-base-300 text-black   avatar  w-16 h-16   border cursor-pointer rounded   border-white",children:(0,s.jsx)("span",{className:"text-2xl",children:d.h.authStore.model().username.charAt(0).toUpperCase()})})})})}),(0,s.jsxs)("ul",{tabIndex:0,style:{border:"dark"===theme?"1px solid #2d2d2d":"1px solid #f9f9f9",borderRadius:"10px"},className:"dropdown-content z-[1] menu   w-[16rem] shadow bg-base-100  rounded ",children:[(0,s.jsx)("li",{children:(0,s.jsx)("a",{className:"rounded-full",onClick:()=>{e.setParams({user:d.h.authStore.model().id}),e.swapPage("user")},children:"View Profile"})}),d.h.authStore.model().postr_plus?(0,s.jsx)("li",{children:(0,s.jsxs)("a",{className:"rounded-full",children:["Your benefits",(0,s.jsx)("span",{className:"badge badge-outline border-blue-500 text-blue-500",children:"++"})]})}):"",(0,s.jsx)("li",{children:(0,s.jsx)("a",{className:"rounded-full",children:"Set Status"})}),(0,s.jsx)("li",{children:(0,s.jsxs)("a",{className:"rounded-full",onClick:()=>{document.getElementById("logout-modal").showModal()},children:["Logout"," ",(0,s.jsxs)("span",{className:"font-bold",children:[" ","@",d.h.authStore.model().username]})]})})]})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{className:"font-bold ",children:d.h.authStore.model().username}),(0,s.jsxs)("p",{className:"text-lg",children:["@",d.h.authStore.model().username+d.h.authStore.model().id.substring(0,4)]})]})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(l.Z,{className:"w-7 h-7 cursor-pointer",onClick:()=>{e.swapPage("bookmarks")}}),(0,s.jsx)(a,{onClick:()=>{e.swapPage("settings")},className:"w-7 h-7 cursor-pointer"})]})]})})})}),_&&!M?(0,s.jsx)("div",{className:"toast p-2  xl:hidden lg:hidden md:hidden toast-end relative sm:toast-center  text-sm ",onClick:()=>{Z(!0)},children:(0,s.jsxs)("div",{className:"alert bg-[#f82d2df5] text-white  hero flex flex-row gap-2   font-bold shadow rounded-box",children:[(0,s.jsx)("span",{children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})})}),(0,s.jsxs)("p",{children:["Poor connection detected.",(0,s.jsx)("p",{children:"Likely due to your internet connection."}),(0,s.jsx)("span",{className:"text-sm",children:" Click to Dismiss"})]})]})}):"",(0,s.jsxs)("div",{className:"flex hero sm:p-3 xl:p-5        justify-between xl:mt-0  ",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{className:"cursor-pointer",onClick:()=>{B("recommended",0)},children:"Recommended"}),"recommended"===N?(0,s.jsx)("div",{className:" rounded-md   h-1 bg-blue-500"}):""]}),(0,s.jsxs)("div",{className:"flex flex-col text-sm",children:[(0,s.jsx)("p",{className:"cursor-pointer",onClick:()=>{B("following",0)},children:"Following"}),"following"===N?(0,s.jsx)("div",{className:" rounded-md   h-1 bg-blue-500"}):""]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{className:"cursor-pointer",onClick:()=>{B("trending",0)},children:"Trending"}),"trending"===N?(0,s.jsx)("div",{className:" rounded-md  h-1 bg-blue-500"}):""]})]})]}),(0,s.jsx)(c.Z,{className:"   xl:mt-0 z-[-1] mt-3   flex flex-col  w-full 0 xl:p-0     ",dataLength:p.length,hasMore:!0,next:F,loader:"",children:p.length>0?p.map((o,t)=>(console.log(o),(0,s.jsx)("div",{className:"     sm:p-3  \n                         ".concat("dark"==theme?"xl:border xl:border-[#121212]":"xl:border xl:border-[#ecececd8]","  \n                        "),id:o.id,children:(0,s.jsx)(n.Z,{isLast:t===p.length-1,cacheKey:"user-home-".concat(N,"-posts-").concat(v,"-").concat(d.h.authStore.model().id),...o,expand:o.expand,post:o,swapPage:e.swapPage,setParams:e.setParams,page:e.currentPage,currentPage:v})},o.id))):(0,s.jsx)(s.Fragment,{children:S?(0,s.jsx)("div",{className:"mx-auto flex justify-center",children:(0,s.jsx)("span",{className:"loading loading-spinner-large loading-spinner mt-5 text-blue-600"})}):S?"":(0,s.jsx)(s.Fragment,{children:"following"===N?(0,s.jsxs)("div",{className:"flex flex-col mt-6  justify-center",children:[(0,s.jsx)("p",{className:"text-center text-xl font-bold",children:"You're not following anyone."}),(0,s.jsx)("p",{className:"text-center text-sm",children:"Follow people to see their posts here."})]}):"recommended"===N?(0,s.jsx)("div",{className:"flex flex-col  justify-center",children:(0,s.jsxs)("p",{className:"text-center text-xl font-bold",children:["No recommended posts. :","("]})}):"trending"===N?(0,s.jsx)("div",{className:"flex flex-col  justify-center",children:(0,s.jsx)("p",{className:"text-center text-xl font-bold",children:"No trending posts."})}):(0,s.jsx)("div",{className:"flex flex-col  justify-center"})})})}),(0,s.jsx)("div",{className:"xl:hidden lg:hidden",children:(0,s.jsx)(i.L,{params:e.params,setParams:e.setParams,currentPage:e.currentPage,swapPage:e.swapPage})})]})})})}}},function(e){e.O(0,[774,545,355,793,888,179],function(){return e(e.s=5669)}),_N_E=e.O()}]);